<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è·å–QQéŸ³ä¹è¿›åº¦æ¡æç¤ºæ–‡æœ¬æ–¹æ³• - DeepSeek</title>
  <meta name="created-at" content="1767027487513">
  <meta name="updated-at" content="1767027487513">
  <meta name="source-type" content="deepseek">
  <meta name="source-url" content="https://chat.deepseek.com/a/chat/s/6d42e481-9cd8-4bd6-9595-f62430a5859e">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
      color: #333;
    }
    h1 {
      color: #333;
      border-bottom: 2px solid #10a37f;
      padding-bottom: 10px;
    }
    .message-block {
      margin: 20px 0;
      padding: 16px;
      border-radius: 12px;
    }
    .role-user {
      background: #e8f4fd;
      border-left: 4px solid #3b82f6;
    }
    .role-ai {
      background: #f0fdf4;
      border-left: 4px solid #10b981;
    }
    .message-role {
      font-weight: 700;
      margin-bottom: 8px;
    }
    .role-user .message-role { color: #2563eb; }
    .role-ai .message-role { color: #059669; }
    .message-content {
      line-height: 1.6;
    }
    pre {
      background: #1a1a1a;
      color: #e5e5e5;
      padding: 16px;
      border-radius: 8px;
      overflow-x: auto;
    }
    code {
      font-family: 'Consolas', 'Monaco', monospace;
    }
    img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>è·å–QQéŸ³ä¹è¿›åº¦æ¡æç¤ºæ–‡æœ¬æ–¹æ³• - DeepSeek</h1>
  <div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">æ€ä¹ˆè·å–winç‰ˆqqéŸ³ä¹çš„â€œé¼ æ ‡æ”¾åˆ°æ‹–æ‹½æ¡ä¸Šå‡ºç°çš„æ–¹æ¡†ä¸­çš„æ–‡æœ¬â€å‘¢</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>è·å–QQéŸ³ä¹Windowså®¢æˆ·ç«¯ä¸­è¿›åº¦æ¡æ‚¬åœæç¤ºæ¡†çš„æ–‡æœ¬ï¼Œé€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§æŠ€æœ¯æ–¹æ¡ˆï¼š</span></p><h2><span>ä¸€ã€UIè‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼ˆæ¨èï¼‰</span></h2><h3><span>1. </span><strong><span>ä½¿ç”¨ Accessibility API (UI Automation)</span></strong></h3><div class="code-block"><pre><code class="language-python">import uiautomation as auto

# æ‰¾åˆ°QQéŸ³ä¹çª—å£
qq_window = auto.WindowControl(Name="QQéŸ³ä¹")
# æŸ¥æ‰¾è¿›åº¦æ¡æ§ä»¶ï¼ˆå¯èƒ½éœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´æŸ¥æ‰¾æ¡ä»¶ï¼‰
progress_bar = qq_window.SliderControl(Name="æ’­æ”¾è¿›åº¦æ¡")

# æ¨¡æ‹Ÿæ‚¬åœ
progress_bar.Hover()
# è·å–å·¥å…·æç¤ºæ–‡æœ¬
tooltip = auto.ToolTipControl(searchFromControl=progress_bar)
print(tooltip.Name)</code></pre></div><h3><span>2. </span><strong><span>ä½¿ç”¨ PyWinAuto</span></strong></h3><div class="code-block"><pre><code class="language-python">from pywinauto import Application
from pywinauto.findwindows import find_window
import time

# è¿æ¥åˆ°QQéŸ³ä¹è¿›ç¨‹
app = Application(backend="uia").connect(title="QQéŸ³ä¹")
window = app.window(title="QQéŸ³ä¹")

# è·å–è¿›åº¦æ¡æ§ä»¶
progress_bar = window.child_window(control_type="ProgressBar")

# è·å–ä½ç½®å¹¶æ¨¡æ‹Ÿé¼ æ ‡æ‚¬åœ
rect = progress_bar.rectangle()
x = (rect.left + rect.right) // 2
y = (rect.top + rect.bottom) // 2

# å¯èƒ½éœ€è¦è§¦å‘æ‚¬åœäº‹ä»¶</code></pre></div><h2><span>äºŒã€Windows APIæ–¹æ¡ˆ</span></h2><h3><span>3. </span><strong><span>ä½¿ç”¨ Win32 API è·å–å·¥å…·æç¤º</span></strong></h3><div class="code-block"><pre><code class="language-csharp">// C# ç¤ºä¾‹
[DllImport("user32.dll")]
static extern IntPtr WindowFromPoint(POINT point);

[DllImport("user32.dll", CharSet = CharSet.Auto)]
static extern int GetWindowText(IntPtr hWnd, StringBuilder text, int count);

// è·å–é¼ æ ‡ä½ç½®ä¸‹çš„çª—å£å¥æŸ„ï¼Œç„¶åè·å–æ–‡æœ¬</code></pre></div><h2><span>ä¸‰ã€é€†å‘å·¥ç¨‹æ–¹æ¡ˆï¼ˆé«˜çº§ï¼‰</span></h2><h3><span>4. </span><strong><span>å†…å­˜è¯»å–</span></strong></h3><ul><li><p class="ds-markdown-paragraph"><span>ä½¿ç”¨ Cheat Engine ç­‰å·¥å…·åˆ†æQQéŸ³ä¹è¿›ç¨‹</span></p></li><li><p class="ds-markdown-paragraph"><span>å®šä½å­˜å‚¨è¿›åº¦æ—¶é—´æ–‡æœ¬çš„å†…å­˜åœ°å€</span></p></li><li><p class="ds-markdown-paragraph"><span>é€šè¿‡è¿›ç¨‹æ³¨å…¥è¯»å–å†…å­˜æ•°æ®</span></p></li></ul><h3><span>5. </span><strong><span>DLLæ³¨å…¥ + Hook</span></strong></h3><div class="code-block"><pre><code class="language-cpp">// Hook ç»˜åˆ¶æ–‡æœ¬çš„å‡½æ•°ï¼ˆå¦‚DrawTextã€TextOutç­‰ï¼‰
// æ‹¦æˆªå¹¶è®°å½•ç»˜åˆ¶å†…å®¹</code></pre></div><h2><span>å››ã€OCRæ–¹æ¡ˆï¼ˆé€šç”¨ä½†è¾ƒæ…¢ï¼‰</span></h2><h3><span>6. </span><strong><span>å±å¹•æˆªå›¾ + OCRè¯†åˆ«</span></strong></h3><div class="code-block"><pre><code class="language-python">import pyautogui
import pytesseract
from PIL import Image

# 1. æ¨¡æ‹Ÿé¼ æ ‡æ‚¬åœåœ¨è¿›åº¦æ¡ä¸Š
# 2. æˆªå–å·¥å…·æç¤ºåŒºåŸŸ
# 3. ä½¿ç”¨OCRè¯†åˆ«æ–‡æœ¬</code></pre></div><h2><span>äº”ã€æ³¨æ„äº‹é¡¹</span></h2><h3><span>âš ï¸ </span><strong><span>é‡è¦æé†’</span></strong><span>ï¼š</span></h3><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>åˆæ³•æ€§å’Œç”¨æˆ·åè®®</span></strong><span>ï¼šQQéŸ³ä¹å¯èƒ½æœ‰ç¦æ­¢è‡ªåŠ¨åŒ–æ“ä½œçš„ç”¨æˆ·åè®®æ¡æ¬¾</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>æŠ€æœ¯éš¾åº¦</span></strong><span>ï¼šQQéŸ³ä¹å¯èƒ½ä½¿ç”¨äº†è‡ªå®šä¹‰æ§ä»¶ï¼Œæ ‡å‡†UIè‡ªåŠ¨åŒ–å¯èƒ½æ— æ³•ç›´æ¥è·å–</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>æ›´æ–°å…¼å®¹æ€§</span></strong><span>ï¼šå®¢æˆ·ç«¯æ›´æ–°å¯èƒ½å¯¼è‡´ä»£ç å¤±æ•ˆ</span></p></li></ol><h3><span>ğŸ“ </span><strong><span>å»ºè®®æ–¹æ¡ˆ</span></strong><span>ï¼š</span></h3><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>ä¼˜å…ˆå°è¯•UI Automationæ–¹æ¡ˆ</span></strong><span>ï¼Œè¿™æ˜¯æœ€æ ‡å‡†çš„Windowsè‡ªåŠ¨åŒ–æ–¹æ³•</span></p></li><li><p class="ds-markdown-paragraph"><span>å¦‚æœæ— æ³•ç›´æ¥è·å–ï¼Œå¯ä»¥å°è¯•</span><strong><span>ä½¿ç”¨Accessibility Insightså·¥å…·</span></strong><span>å…ˆåˆ†ææ§ä»¶ç»“æ„</span></p></li><li><p class="ds-markdown-paragraph"><span>å¯¹äºä¸ªäººå­¦ä¹ ä½¿ç”¨ï¼Œå¯ä»¥è€ƒè™‘OCRæ–¹æ¡ˆï¼Œè™½ç„¶è¾ƒæ…¢ä½†æœ€é€šç”¨</span></p></li></ol><h3><span>ğŸ”§ </span><strong><span>è°ƒè¯•å·¥å…·æ¨è</span></strong><span>ï¼š</span></h3><ul><li><p class="ds-markdown-paragraph"><strong><span>Accessibility Insights</span></strong><span>ï¼šåˆ†æUIæ§ä»¶ç»“æ„</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>Spy++</span></strong><span>ï¼šæŸ¥çœ‹çª—å£æ¶ˆæ¯å’Œå±æ€§</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>AutoHotkey</span></strong><span>ï¼šå¿«é€Ÿç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬</span></p></li></ul><p class="ds-markdown-paragraph"><span>éœ€è¦æ ¹æ®ä½ çš„å…·ä½“ä½¿ç”¨åœºæ™¯ï¼ˆè‡ªåŠ¨åŒ–æµ‹è¯•ã€è¾…åŠ©å·¥å…·ã€ä¸ªäººå­¦ä¹ ç­‰ï¼‰é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆã€‚å¦‚æœæ˜¯å•†ä¸šç”¨é€”ï¼Œè¯·åŠ¡å¿…éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œè½¯ä»¶è®¸å¯åè®®ã€‚</span></p></div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">UIæ–¹æ¡ˆä¸¤ä¸ªéƒ½æŠ¥é”™äº†ï¼š
î‚¶î˜ª jewel@TOKî‚´ D:\..î—¾..\HaloPixelToolBoxî‚´ îœ¥ mainî‚´ python .\q.py
Traceback (most recent call last):
  File "D:\software\HaloPixelToolBox\q.py", line 9, in &lt;module&gt;
    progress_bar.Hover()
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'SliderControl' object has no attribute 'Hover'
î‚¶î˜ª jewel@TOKî‚´ D:\..î—¾..\HaloPixelToolBoxî‚´ îœ¥ mainî‚´ python .\q.py
Traceback (most recent call last):
  File "D:\software\HaloPixelToolBox\q.py", line 6, in &lt;module&gt;
    app = Application(backend="uia").connect(title="QQéŸ³ä¹")
          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "D:\Program Files\python314\Lib\site-packages\pywinauto\application.py", line 997, in connect
    self.process = findwindows.find_element(**kwargs).process_id
                   ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\Program Files\python314\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'QQéŸ³ä¹', 'backend': 'uia', 'visible_only': False}</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>è¿™ä¸ªé”™è¯¯è¡¨æ˜æˆ‘ä»¬éœ€è¦è°ƒæ•´æ–¹æ³•æ¥æ­£ç¡®æ“ä½œQQéŸ³ä¹çš„æ§ä»¶ã€‚è®©æˆ‘æä¾›ä¿®æ­£åçš„ä»£ç å’Œè°ƒè¯•æ–¹æ³•ï¼š</span></p><h2><span>ä¸€ã€è°ƒè¯•å’Œä¿®æ­£</span></h2><h3><span>1. </span><strong><span>è°ƒè¯•QQéŸ³ä¹çª—å£ç»“æ„</span></strong></h3><p class="ds-markdown-paragraph"><span>é¦–å…ˆæŸ¥çœ‹QQéŸ³ä¹çš„çª—å£ç»“æ„ï¼š</span></p><div class="code-block"><pre><code class="language-python"># debug_window.py - è°ƒè¯•QQéŸ³ä¹çª—å£ç»“æ„
import uiautomation as auto
import time

# åˆ—å‡ºæ‰€æœ‰é¡¶çº§çª—å£
print("=== æ‰€æœ‰é¡¶çº§çª—å£ ===")
for window in auto.GetRootControl().GetChildren():
    if window.Name:
        print(f"çª—å£: {window.Name} (ç±»å: {window.ClassName})")

# æŸ¥æ‰¾åŒ…å«"QQéŸ³ä¹"çš„çª—å£
print("\n=== æŸ¥æ‰¾QQéŸ³ä¹ç›¸å…³çª—å£ ===")
qq_windows = []
for window in auto.WalkControl(auto.GetRootControl()):
    if "QQéŸ³ä¹" in window.Name:
        qq_windows.append(window)
        print(f"æ‰¾åˆ°çª—å£: {window.Name}, ç±»å: {window.ClassName}, ControlType: {window.ControlTypeName}")

# æˆ–è€…ä½¿ç”¨æ›´ç®€å•çš„æ–¹æ³•æŸ¥æ‰¾
print("\n=== å°è¯•ç›´æ¥æŸ¥æ‰¾ ===")
time.sleep(2)  # åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£
window = auto.WindowControl(searchDepth=1, ClassName='TXGuiFoundation', Name='QQéŸ³ä¹')
if window.Exists(3, 1):
    print("æ‰¾åˆ°ä¸»çª—å£")
    window.SetActive()
    # æ‰“å°çª—å£çš„æ‰€æœ‰å­æ§ä»¶
    for control in window.GetChildren():
        print(f"æ§ä»¶: {control.ControlTypeName} - {control.Name}")</code></pre></div><h3><span>2. </span><strong><span>æ­£ç¡®çš„è¿›åº¦æ¡æ‚¬åœæ–¹æ³•</span></strong></h3><div class="code-block"><pre><code class="language-python"># qq_music_tooltip.py
import uiautomation as auto
import time

def get_qq_music_tooltip():
    """è·å–QQéŸ³ä¹è¿›åº¦æ¡æ‚¬åœæç¤º"""
    try:
        # æ–¹æ³•1ï¼šé€šè¿‡è¿›ç¨‹åæŸ¥æ‰¾
        # app = auto.Application(executable_path='QQMusic.exe')
        # window = app.WindowControl(Name='QQéŸ³ä¹')
        
        # æ–¹æ³•2ï¼šç›´æ¥æŸ¥æ‰¾çª—å£ï¼ˆQQéŸ³ä¹é€šå¸¸ä½¿ç”¨è¿™ä¸ªç±»åï¼‰
        window = auto.WindowControl(
            searchDepth=1, 
            ClassName='TXGuiFoundation', 
            Name='QQéŸ³ä¹'
        )
        
        if not window.Exists(5, 1):
            print("æœªæ‰¾åˆ°QQéŸ³ä¹çª—å£ï¼Œè¯·ç¡®ä¿QQéŸ³ä¹æ­£åœ¨è¿è¡Œ")
            return None
        
        print("æ‰¾åˆ°QQéŸ³ä¹çª—å£")
        
        # æŸ¥æ‰¾æ‰€æœ‰è¿›åº¦æ¡æˆ–æ»‘å—æ§ä»¶
        sliders = []
        for ctrl in window.GetChildren():
            if ctrl.ControlType == auto.ControlType.SliderControl:
                sliders.append(ctrl)
                print(f"æ‰¾åˆ°æ»‘å—: {ctrl.Name}")
        
        if not sliders:
            # å°è¯•é€šè¿‡æ–‡æœ¬æŸ¥æ‰¾
            progress_bars = window.GetChildren(ClassName='msctls_progress32')
            print(f"æ‰¾åˆ°è¿›åº¦æ¡æ•°é‡: {len(progress_bars)}")
        
        # æ¨¡æ‹Ÿé¼ æ ‡ç§»åŠ¨åˆ°è¿›åº¦æ¡ä¸Š
        # å…ˆå°è¯•è·å–çª—å£ä½ç½®
        rect = window.BoundingRectangle
        print(f"çª—å£ä½ç½®: {rect}")
        
        # å‡è®¾è¿›åº¦æ¡åœ¨çª—å£ä¸­é—´åä¸‹çš„ä½ç½®
        # QQéŸ³ä¹çš„è¿›åº¦æ¡é€šå¸¸åœ¨åº•éƒ¨
        progress_bar_y = rect.bottom - 50  # è·åº•éƒ¨50åƒç´ 
        progress_bar_x = rect.left + 200   # ä»å·¦è¾¹200åƒç´ å¼€å§‹
        
        # ç§»åŠ¨é¼ æ ‡åˆ°è¿›åº¦æ¡ä¸Šï¼ˆæµ‹è¯•ä¸åŒä½ç½®ï¼‰
        for x in range(progress_bar_x, rect.right - 100, 50):
            auto.SetCursorPos(x, progress_bar_y)
            time.sleep(0.5)
            
            # æŸ¥æ‰¾å‡ºç°çš„å·¥å…·æç¤ºçª—å£
            tooltips = []
            for tip in auto.GetRootControl().GetChildren():
                if tip.ControlType == auto.ControlType.ToolTipControl:
                    tooltips.append(tip)
                    print(f"æ‰¾åˆ°å·¥å…·æç¤º: {tip.Name}")
            
            if tooltips:
                return tooltips[0].Name
        
        return None
        
    except Exception as e:
        print(f"é”™è¯¯: {e}")
        import traceback
        traceback.print_exc()
        return None

if __name__ == "__main__":
    result = get_qq_music_tooltip()
    print(f"è·å–åˆ°çš„æç¤ºæ–‡æœ¬: {result}")</code></pre></div><h3><span>3. </span><strong><span>ä½¿ç”¨æ§ä»¶çš„ç›¸å¯¹åæ ‡</span></strong></h3><div class="code-block"><pre><code class="language-python"># qq_music_detailed.py
import uiautomation as auto
import time

def find_and_hover_progress_bar():
    """æ›´ç²¾ç¡®åœ°æŸ¥æ‰¾å’Œæ‚¬åœè¿›åº¦æ¡"""
    
    # æŸ¥æ‰¾QQéŸ³ä¹ä¸»çª—å£
    window = auto.PaneControl(ClassName='TXGuiFoundation', Name='QQéŸ³ä¹')
    
    if not window.Exists(5, 1):
        print("è¯·å…ˆå¯åŠ¨QQéŸ³ä¹")
        return
    
    print("QQéŸ³ä¹çª—å£å·²æ‰¾åˆ°")
    
    # æœ€å°åŒ–å†æ¢å¤ä»¥æ¿€æ´»çª—å£
    window.SetFocus()
    time.sleep(1)
    
    # ä½¿ç”¨Inspectå·¥å…·æŸ¥çœ‹çš„å…·ä½“æ§ä»¶ä¿¡æ¯
    # QQéŸ³ä¹å¯èƒ½ä½¿ç”¨è‡ªå®šä¹‰æ§ä»¶ï¼Œå°è¯•ä¸åŒæ–¹æ³•
    
    # æ–¹æ³•1ï¼šé€šè¿‡åç§°æŸ¥æ‰¾æ’­æ”¾æ§åˆ¶åŒºåŸŸ
    playback_area = window.PaneControl(Name='æ’­æ”¾æ§åˆ¶åŒºåŸŸ')
    
    # æ–¹æ³•2ï¼šæŸ¥æ‰¾åŒ…å«æ—¶é—´æ˜¾ç¤ºçš„æ§ä»¶
    for control in window.GetChildren():
        control_type = control.ControlTypeName
        name = control.Name
        
        # è¾“å‡ºæœ‰ç”¨çš„æ§ä»¶ä¿¡æ¯ç”¨äºè°ƒè¯•
        if name and len(name) &gt; 0:
            print(f"[{control_type}] {name}")
            
            # æ—¶é—´ç›¸å…³çš„æ§ä»¶
            if any(time_keyword in name for time_keyword in ['æ—¶é—´', ':', '/', 'æ’­æ”¾']):
                print(f"  å¯èƒ½ç›¸å…³: {name}")
                
                # è·å–ä½ç½®ä¿¡æ¯
                try:
                    rect = control.BoundingRectangle
                    print(f"  ä½ç½®: ({rect.left}, {rect.top}) - ({rect.right}, {rect.bottom})")
                    
                    # å¦‚æœæ˜¯è¿›åº¦æ¡æˆ–æ»‘å—
                    if control.ControlType == auto.ControlType.SliderControl:
                        print("  è¿™æ˜¯ä¸€ä¸ªæ»‘å—æ§ä»¶")
                        
                        # è·å–è¿›åº¦æ¡ç›¸å…³ä¿¡æ¯
                        print(f"  å€¼: {control.GetValuePattern().Value}")
                        print(f"  èŒƒå›´: {control.GetRangeValuePattern().Minimum}-{control.GetRangeValuePattern().Maximum}")
                        
                        # ç§»åŠ¨åˆ°æ§ä»¶ä¸­å¿ƒ
                        center_x = (rect.left + rect.right) // 2
                        center_y = (rect.top + rect.bottom) // 2
                        
                        # æ¨¡æ‹Ÿæ‚¬åœ
                        auto.SetCursorPos(center_x, center_y)
                        time.sleep(1)
                        
                        # æŸ¥æ‰¾å·¥å…·æç¤º
                        tooltip = auto.ToolTipControl()
                        if tooltip.Exists(0.5, 0.1):
                            print(f"  å·¥å…·æç¤º: {tooltip.Name}")
                            return tooltip.Name
                except:
                    pass
    
    return None

if __name__ == "__main__":
    result = find_and_hover_progress_bar()
    print(f"ç»“æœ: {result}")</code></pre></div><h3><span>4. </span><strong><span>ä½¿ç”¨æ›´ç›´æ¥çš„é¼ æ ‡æ¨¡æ‹Ÿ</span></strong></h3><div class="code-block"><pre><code class="language-python"># mouse_simulation.py
import uiautomation as auto
import time
import pyautogui

def get_tooltip_by_mouse():
    """é€šè¿‡é¼ æ ‡æ¨¡æ‹Ÿè·å–å·¥å…·æç¤º"""
    
    # æŸ¥æ‰¾çª—å£
    window = auto.WindowControl(ClassName='TXGuiFoundation', Name='QQéŸ³ä¹')
    
    if not window.Exists(3, 1):
        print("QQéŸ³ä¹æœªè¿è¡Œ")
        return None
    
    # æ¿€æ´»çª—å£
    window.SetActive()
    time.sleep(0.5)
    
    # è·å–çª—å£ä½ç½®
    rect = window.BoundingRectangle
    print(f"çª—å£ä½ç½®: {rect}")
    
    # åœ¨çª—å£å†…æŸ¥æ‰¾å¯èƒ½çš„è¿›åº¦æ¡åŒºåŸŸ
    # QQéŸ³ä¹è¿›åº¦æ¡é€šå¸¸åœ¨çª—å£åº•éƒ¨ä¸­é—´ä½ç½®
    
    # æ–¹æ³•1ï¼šä»ä¸‹å¾€ä¸Šæ‰«æ
    for y in range(rect.bottom - 30, rect.bottom - 100, -5):
        for x in range(rect.left + 100, rect.right - 100, 30):
            # ç§»åŠ¨é¼ æ ‡
            pyautogui.moveTo(x, y, duration=0.05)
            time.sleep(0.1)
            
            # æŸ¥æ‰¾å·¥å…·æç¤º
            try:
                tooltip = auto.ToolTipControl()
                if tooltip.Exists(0.1, 0.05):
                    text = tooltip.Name
                    if text and len(text.strip()) &gt; 0:
                        print(f"åœ¨ä½ç½® ({x}, {y}) æ‰¾åˆ°æç¤º: {text}")
                        return text
            except:
                pass
    
    return None

if __name__ == "__main__":
    # å…ˆåˆ‡æ¢åˆ°QQéŸ³ä¹
    print("5ç§’å†…è¯·åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£...")
    time.sleep(5)
    
    result = get_tooltip_by_mouse()
    print(f"æœ€ç»ˆç»“æœ: {result}")</code></pre></div><h3><span>5. </span><strong><span>ä½¿ç”¨æ›´é«˜çº§çš„å·¥å…·åˆ†æ</span></strong></h3><p class="ds-markdown-paragraph"><span>å¦‚æœä¸Šè¿°æ–¹æ³•éƒ½ä¸è¡Œï¼Œå»ºè®®ä½¿ç”¨ä¸“é—¨çš„UIåˆ†æå·¥å…·ï¼š</span></p><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>Accessibility Insights for Windows</span></strong></p><ul><li><p class="ds-markdown-paragraph"><span>ä¸‹è½½å¹¶è¿è¡Œ</span></p></li><li><p class="ds-markdown-paragraph"><span>ä½¿ç”¨"FastPass"æ¨¡å¼æ‰«æQQéŸ³ä¹çª—å£</span></p></li><li><p class="ds-markdown-paragraph"><span>æŸ¥çœ‹æ§ä»¶çš„å®Œæ•´å±æ€§å’Œç»“æ„</span></p></li></ul></li><li><p class="ds-markdown-paragraph"><strong><span>ä½¿ç”¨ Spy++ (Visual Studio é™„å¸¦)</span></strong></p><ul><li><p class="ds-markdown-paragraph"><span>å¯ä»¥æŸ¥çœ‹çª—å£æ¶ˆæ¯å’Œå±‚çº§ç»“æ„</span></p></li></ul></li><li><p class="ds-markdown-paragraph"><strong><span>åˆ›å»ºè‡ªåŠ¨åŒ–è¾…åŠ©å·¥å…·</span></strong></p></li></ol><div class="code-block"><pre><code class="language-python"># ui_explorer.py - æ¢ç´¢UIç»“æ„
import uiautomation as auto

def explore_controls(control, depth=0, max_depth=3):
    """é€’å½’æ¢ç´¢æ§ä»¶æ ‘"""
    if depth &gt; max_depth:
        return
    
    indent = "  " * depth
    try:
        name = control.Name if control.Name else ""
        control_type = control.ControlTypeName
        
        # åªæ˜¾ç¤ºæœ‰åç§°æˆ–ç‰¹å®šç±»å‹çš„æ§ä»¶
        if name or control_type in ["SliderControl", "ProgressBarControl", "ToolTipControl"]:
            print(f"{indent}[{control_type}] {name}")
            
            # å¦‚æœæ˜¯å·¥å…·æç¤ºï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯
            if control_type == "ToolTipControl":
                print(f"{indent}  æ–‡æœ¬: {control.Name}")
                rect = control.BoundingRectangle
                print(f"{indent}  ä½ç½®: {rect}")
        
        # é€’å½’å­æ§ä»¶
        for child in control.GetChildren():
            explore_controls(child, depth + 1, max_depth)
    except:
        pass

# æŸ¥æ‰¾QQéŸ³ä¹çª—å£å¹¶æ¢ç´¢
window = None
for w in auto.GetRootControl().GetChildren():
    if w.Name and "QQéŸ³ä¹" in w.Name:
        window = w
        break

if window:
    print(f"æ¢ç´¢çª—å£: {window.Name}")
    explore_controls(window)
else:
    print("æœªæ‰¾åˆ°QQéŸ³ä¹çª—å£")</code></pre></div><h3><span>6. </span><strong><span>ä½¿ç”¨OCRä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ</span></strong></h3><div class="code-block"><pre><code class="language-python"># ocr_tooltip.py
import pyautogui
import pytesseract
from PIL import Image, ImageGrab
import time

def capture_and_ocr_tooltip():
    """é€šè¿‡æˆªå›¾å’ŒOCRè¯†åˆ«å·¥å…·æç¤º"""
    
    # ç¡®ä¿QQéŸ³ä¹åœ¨å‰å°
    print("è¯·åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£...")
    time.sleep(3)
    
    # è·å–å±å¹•å°ºå¯¸
    screen_width, screen_height = pyautogui.size()
    
    # åœ¨é¼ æ ‡ä½ç½®é™„è¿‘æˆªå–å°åŒºåŸŸ
    mouse_x, mouse_y = pyautogui.position()
    
    # è®¡ç®—æˆªå›¾åŒºåŸŸï¼ˆé¼ æ ‡ä¸Šæ–¹çš„å°åŒºåŸŸï¼‰
    capture_area = (
        mouse_x - 100, mouse_y - 50,  # å·¦ä¸Šè§’
        mouse_x + 100, mouse_y + 10   # å³ä¸‹è§’
    )
    
    # æˆªå›¾
    screenshot = ImageGrab.grab(bbox=capture_area)
    
    # ä¿å­˜æˆªå›¾ç”¨äºè°ƒè¯•
    screenshot.save("tooltip_screenshot.png")
    
    # ä½¿ç”¨OCRè¯†åˆ«
    text = pytesseract.image_to_string(screenshot, lang='chi_sim')
    
    # æ¸…ç†æ–‡æœ¬
    text = text.strip()
    
    if text:
        print(f"è¯†åˆ«åˆ°çš„æ–‡æœ¬: {text}")
        return text
    else:
        print("æœªè¯†åˆ«åˆ°æ–‡æœ¬")
        return None

if __name__ == "__main__":
    # å…ˆç§»åŠ¨é¼ æ ‡åˆ°è¿›åº¦æ¡ä¸Š
    print("5ç§’å†…è¯·å°†é¼ æ ‡ç§»åŠ¨åˆ°QQéŸ³ä¹è¿›åº¦æ¡ä¸Š...")
    time.sleep(5)
    
    # ç¨ç­‰è®©å·¥å…·æç¤ºå‡ºç°
    time.sleep(0.5)
    
    result = capture_and_ocr_tooltip()</code></pre></div><h2><span>äºŒã€å»ºè®®çš„è°ƒè¯•æ­¥éª¤</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>å…ˆè¿è¡Œ </span><code>debug_window.py</code></strong><span> æŸ¥çœ‹QQéŸ³ä¹çš„çª—å£ç»“æ„</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>ä½¿ç”¨Accessibility Insightså·¥å…·</span></strong><span> åˆ†æå…·ä½“çš„æ§ä»¶å±æ€§</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>è°ƒæ•´æ§ä»¶æŸ¥æ‰¾æ¡ä»¶</span></strong><span> æ ¹æ®å®é™…çœ‹åˆ°çš„å±æ€§ä¿®æ”¹ä»£ç </span></p></li><li><p class="ds-markdown-paragraph"><strong><span>å°è¯•ä¸åŒçš„é¼ æ ‡ä½ç½®</span></strong><span> QQéŸ³ä¹çš„UIå¯èƒ½æ¯”è¾ƒå¤æ‚</span></p></li></ol><p class="ds-markdown-paragraph"><span>å¦‚æœè¿™äº›æ–¹æ³•éƒ½ä¸è¡Œï¼Œå¯èƒ½éœ€è¦è€ƒè™‘QQéŸ³ä¹ä½¿ç”¨äº†ç‰¹æ®Šçš„UIæ¡†æ¶ï¼ˆå¦‚Qtã€Electronç­‰ï¼‰ï¼Œéœ€è¦ä¸“é—¨çš„è‡ªåŠ¨åŒ–æ–¹æ³•ã€‚è¯·å‘Šè¯‰æˆ‘ä½ è¿è¡Œè°ƒè¯•è„šæœ¬çš„å…·ä½“ç»“æœï¼Œæˆ‘å¯ä»¥æä¾›æ›´ç²¾ç¡®çš„è§£å†³æ–¹æ¡ˆã€‚</span></p></div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">=== æ‰€æœ‰é¡¶çº§çª—å£ ===
çª—å£: ä»»åŠ¡æ  (ç±»å: Shell_TrayWnd)
çª—å£: Administrator: PowerShell (ç±»å: CASCADIA_HOSTING_WINDOW_CLASS)
çª—å£: q.py - HaloPixelToolBox - Cursor (ç±»å: Chrome_WidgetWin_1)
çª—å£: è·å–QQéŸ³ä¹è¿›åº¦æ¡æç¤ºæ–‡æœ¬æ–¹æ³• - DeepSeek å’Œå¦å¤– 41 ä¸ªé¡µé¢ - ç”¨æˆ·é…ç½® 1 - Microsoftâ€‹ Edge (ç±»å: Chrome_WidgetWin_1)
çª—å£: LiLyric - æ–‡ä»¶èµ„æºç®¡ç†å™¨ (ç±»å: CabinetWClass)
çª—å£: è¿Ÿæ¥çš„æƒ…è¯ - å¼ å®¶æ—º    (ç±»å: TXGuiFoundation)
çª—å£: Cheat Engine (ç±»å: Window)
çª—å£: ä»»åŠ¡ç®¡ç†å™¨ (ç±»å: TaskManagerWindow)
çª—å£: settings.json - Notepad (ç±»å: Notepad)
çª—å£: QQ (ç±»å: Chrome_WidgetWin_1)
çª—å£: Steam (ç±»å: SDL_app)
çª—å£: Clash Verge (ç±»å: Tauri Window)
çª—å£: dummyLayeredWnd (ç±»å: DuiHostWnd)
çª—å£: dummyLayeredWnd (ç±»å: DuiHostWnd)
çª—å£: NxDock (ç±»å: ThunderRT5Form)
çª—å£: Program Manager (ç±»å: Progman)

=== æŸ¥æ‰¾QQéŸ³ä¹ç›¸å…³çª—å£ ===
Traceback (most recent call last):
  File "D:\software\HaloPixelToolBox\q.py", line 15, in &lt;module&gt;
    if "QQéŸ³ä¹" in window.Name:</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>å¾ˆå¥½ï¼ä»è°ƒè¯•è¾“å‡ºå¯ä»¥çœ‹åˆ°å‡ ä¸ªé‡è¦ä¿¡æ¯ï¼š</span></p><h2><span>å…³é”®å‘ç°ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><span>QQéŸ³ä¹çª—å£çš„</span><strong><span>ç±»å</span></strong><span>æ˜¯ </span><code>TXGuiFoundation</code></p></li><li><p class="ds-markdown-paragraph"><span>çª—å£çš„</span><strong><span>åç§°</span></strong><span>æ˜¯åŠ¨æ€çš„ï¼ŒåŒ…å«å½“å‰æ’­æ”¾çš„æ­Œæ›²ä¿¡æ¯ï¼š</span><code>è¿Ÿæ¥çš„æƒ…è¯ - å¼ å®¶æ—º    </code></p></li><li><p class="ds-markdown-paragraph"><span>çª—å£åç§°æœ€åæœ‰å¤šä¸ªç©ºæ ¼ï¼ˆæ³¨æ„æœ«å°¾çš„ç©ºæ ¼ï¼‰</span></p></li></ol><h2><span>ä¿®æ­£åçš„ä»£ç ï¼š</span></h2><h3><span>1. </span><strong><span>ç›´æ¥ä½¿ç”¨ç±»åæŸ¥æ‰¾çª—å£</span></strong></h3><div class="code-block"><pre><code class="language-python"># æ–¹æ³•1ï¼šç›´æ¥ä½¿ç”¨ç±»åæŸ¥æ‰¾ï¼ˆæ¨èï¼‰
import uiautomation as auto
import time
import pyautogui

def get_qq_music_tooltip():
    """è·å–QQéŸ³ä¹è¿›åº¦æ¡æ‚¬åœæç¤º"""
    try:
        # ä½¿ç”¨ç±»åæŸ¥æ‰¾çª—å£ï¼Œä¸æŒ‡å®šå…·ä½“åç§°
        # QQéŸ³ä¹çš„çª—å£ç±»åé€šå¸¸æ˜¯ TXGuiFoundation
        window = auto.WindowControl(ClassName='TXGuiFoundation')
        
        if not window.Exists(5, 1):
            # å¦‚æœæ‰¾ä¸åˆ°ï¼Œå°è¯•æŸ¥æ‰¾åŒ…å«"éŸ³ä¹"çš„çª—å£
            for w in auto.GetRootControl().GetChildren():
                if w.Name and "éŸ³ä¹" in w.Name:
                    window = w
                    break
        
        if not window.Exists(3, 1):
            print("è¯·å…ˆå¯åŠ¨QQéŸ³ä¹å¹¶æ’­æ”¾æ­Œæ›²")
            return None
        
        print(f"æ‰¾åˆ°QQéŸ³ä¹çª—å£: {window.Name}")
        
        # æ¿€æ´»çª—å£
        window.SetActive()
        time.sleep(0.5)
        
        # è·å–çª—å£ä½ç½®å’Œå¤§å°
        rect = window.BoundingRectangle
        print(f"çª—å£ä½ç½®: {rect}")
        
        # QQéŸ³ä¹è¿›åº¦æ¡é€šå¸¸ä½äºçª—å£åº•éƒ¨
        # è®¡ç®—å¯èƒ½çš„è¿›åº¦æ¡åŒºåŸŸ
        progress_bar_y = rect.bottom - 50  # è·ç¦»åº•éƒ¨50åƒç´ 
        progress_bar_height = 10  # è¿›åº¦æ¡é«˜åº¦çº¦10åƒç´ 
        
        # åœ¨è¿›åº¦æ¡åŒºåŸŸæ°´å¹³ç§»åŠ¨é¼ æ ‡ï¼Œå¯»æ‰¾å·¥å…·æç¤º
        for x in range(rect.left + 100, rect.right - 100, 20):
            # åœ¨è¿›åº¦æ¡é«˜åº¦çš„èŒƒå›´å†…å‚ç›´æ‰«æ
            for y_offset in range(-5, 6, 2):  # ä¸Šä¸‹æ‰«æ
                y = progress_bar_y + y_offset
                pyautogui.moveTo(x, y, duration=0.05)
                time.sleep(0.1)
                
                # æ£€æŸ¥æ˜¯å¦æœ‰å·¥å…·æç¤ºå‡ºç°
                try:
                    # æŸ¥æ‰¾æ‰€æœ‰å·¥å…·æç¤ºæ§ä»¶
                    for control in auto.GetRootControl().GetChildren():
                        if control.ControlType == auto.ControlType.ToolTipControl:
                            text = control.Name
                            if text and len(text.strip()) &gt; 0:
                                print(f"æ‰¾åˆ°å·¥å…·æç¤º: {text}")
                                return text
                except:
                    pass
        
        print("æœªæ‰¾åˆ°å·¥å…·æç¤º")
        return None
        
    except Exception as e:
        print(f"é”™è¯¯: {e}")
        return None

if __name__ == "__main__":
    print("5ç§’å†…è¯·åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£...")
    time.sleep(5)
    result = get_qq_music_tooltip()
    print(f"ç»“æœ: {result}")</code></pre></div><h3><span>2. </span><strong><span>æ›´ç²¾ç¡®çš„æ–¹æ³•ï¼šé€šè¿‡æ§ä»¶IDæŸ¥æ‰¾</span></strong></h3><div class="code-block"><pre><code class="language-python"># æ–¹æ³•2ï¼šä½¿ç”¨Inspectå·¥å…·è·å–çš„æ§ä»¶ID
import uiautomation as auto
import time

def get_tooltip_by_control_id():
    """é€šè¿‡æ§ä»¶è‡ªåŠ¨åŒ–IDæŸ¥æ‰¾"""
    try:
        # æŸ¥æ‰¾QQéŸ³ä¹çª—å£
        window = auto.WindowControl(ClassName='TXGuiFoundation')
        
        if not window.Exists(5, 1):
            return None
        
        print(f"çª—å£æ ‡é¢˜: {window.Name}")
        
        # æ–¹æ³•Aï¼šæŸ¥æ‰¾æ‰€æœ‰æ»‘å—æ§ä»¶
        print("æŸ¥æ‰¾æ»‘å—æ§ä»¶...")
        for control in window.GetChildren():
            if control.ControlType == auto.ControlType.SliderControl:
                print(f"æ‰¾åˆ°æ»‘å—: {control.Name}")
                rect = control.BoundingRectangle
                print(f"ä½ç½®: {rect}")
                
                # ç§»åŠ¨åˆ°æ»‘å—ä¸­å¿ƒ
                center_x = (rect.left + rect.right) // 2
                center_y = (rect.top + rect.bottom) // 2
                auto.SetCursorPos(center_x, center_y)
                time.sleep(1)
                
                # æŸ¥æ‰¾å·¥å…·æç¤º
                tooltip = auto.ToolTipControl()
                if tooltip.Exists(0.5, 0.1):
                    return tooltip.Name
        
        # æ–¹æ³•Bï¼šæŸ¥æ‰¾æ‰€æœ‰æŒ‰é’®ï¼ˆQQéŸ³ä¹çš„è¿›åº¦æ¡å¯èƒ½è¢«å®ç°ä¸ºæŒ‰é’®ï¼‰
        print("\næŸ¥æ‰¾æŒ‰é’®æ§ä»¶...")
        for control in window.GetChildren():
            if control.ControlType == auto.ControlType.ButtonControl:
                name = control.Name
                if name and any(keyword in name for keyword in ['è¿›åº¦', 'æ’­æ”¾', 'æ—¶é—´']):
                    print(f"æ‰¾åˆ°ç›¸å…³æŒ‰é’®: {name}")
        
        # æ–¹æ³•Cï¼šä½¿ç”¨æ›´é€šç”¨çš„æ–¹æ³•ï¼Œéå†æ‰€æœ‰æ§ä»¶
        print("\néå†æ‰€æœ‰æ§ä»¶...")
        controls = []
        for control in window.GetChildren():
            controls.append(control)
            
        print(f"æ€»å…±æ‰¾åˆ° {len(controls)} ä¸ªæ§ä»¶")
        
        # æ‰“å°å‰20ä¸ªæ§ä»¶çš„ä¿¡æ¯
        for i, control in enumerate(controls[:20]):
            print(f"{i}: {control.ControlTypeName} - {control.Name}")
        
        return None
        
    except Exception as e:
        print(f"é”™è¯¯: {e}")
        return None

if __name__ == "__main__":
    result = get_tooltip_by_control_id()
    print(f"ç»“æœ: {result}")</code></pre></div><h3><span>3. </span><strong><span>ä½¿ç”¨Windows APIç›´æ¥è·å–å·¥å…·æç¤º</span></strong></h3><div class="code-block"><pre><code class="language-python"># æ–¹æ³•3ï¼šä½¿ç”¨Windows API
import ctypes
import ctypes.wintypes
import time

user32 = ctypes.windll.user32

class POINT(ctypes.Structure):
    _fields_ = [("x", ctypes.c_long), ("y", ctypes.c_long)]

def get_tooltip_text():
    """ä½¿ç”¨Windows APIè·å–å·¥å…·æç¤ºæ–‡æœ¬"""
    # è·å–å½“å‰é¼ æ ‡ä½ç½®
    pt = POINT()
    user32.GetCursorPos(ctypes.byref(pt))
    
    # è·å–é¼ æ ‡ä½ç½®ä¸‹çš„çª—å£å¥æŸ„
    hwnd = user32.WindowFromPoint(pt)
    
    if hwnd:
        # è·å–çª—å£ç±»å
        class_name = ctypes.create_unicode_buffer(256)
        user32.GetClassNameW(hwnd, class_name, 256)
        
        # è·å–çª—å£æ–‡æœ¬
        text = ctypes.create_unicode_buffer(256)
        user32.GetWindowTextW(hwnd, text, 256)
        
        # æ£€æŸ¥æ˜¯å¦æ˜¯å·¥å…·æç¤ºçª—å£ï¼ˆç±»åé€šå¸¸ä¸º"tooltips_class32"ï¼‰
        if "tooltip" in class_name.value.lower() or len(text.value.strip()) &gt; 0:
            return text.value
    
    return None

def monitor_qq_music_tooltip():
    """ç›‘æ§QQéŸ³ä¹å·¥å…·æç¤º"""
    print("ç›‘æ§QQéŸ³ä¹å·¥å…·æç¤ºï¼ŒæŒ‰Ctrl+Cåœæ­¢...")
    last_text = ""
    
    try:
        while True:
            # è·å–å½“å‰æ´»åŠ¨çª—å£
            hwnd = user32.GetForegroundWindow()
            if hwnd:
                text = ctypes.create_unicode_buffer(256)
                user32.GetWindowTextW(hwnd, text, 256)
                window_title = text.value
                
                # å¦‚æœæ˜¯QQéŸ³ä¹çª—å£
                if "éŸ³ä¹" in window_title or "QQ" in window_title:
                    tooltip_text = get_tooltip_text()
                    if tooltip_text and tooltip_text != last_text:
                        print(f"å·¥å…·æç¤º: {tooltip_text}")
                        last_text = tooltip_text
            
            time.sleep(0.1)
    except KeyboardInterrupt:
        print("ç›‘æ§å·²åœæ­¢")

if __name__ == "__main__":
    monitor_qq_music_tooltip()</code></pre></div><h3><span>4. </span><strong><span>ç®€åŒ–ç‰ˆï¼šä½¿ç”¨é”®ç›˜å¿«æ·é”®è§¦å‘</span></strong></h3><div class="code-block"><pre><code class="language-python"># æ–¹æ³•4ï¼šç»“åˆé”®ç›˜å¿«æ·é”®
import uiautomation as auto
import pyautogui
import time

def get_tooltip_simple():
    """ç®€åŒ–ç‰ˆï¼šå…ˆèšç„¦åˆ°QQéŸ³ä¹ï¼Œç„¶åé¼ æ ‡ç§»åŠ¨åˆ°å¸¸è§ä½ç½®"""
    
    # åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£
    window = auto.WindowControl(ClassName='TXGuiFoundation')
    if window.Exists(3, 1):
        window.SetActive()
        time.sleep(0.5)
        
        # ä½¿ç”¨é”®ç›˜å¿«æ·é”® Ctrl+1 ç¡®ä¿ç„¦ç‚¹åœ¨æ’­æ”¾åŒºåŸŸ
        pyautogui.hotkey('ctrl', '1')
        time.sleep(0.5)
        
        # è·å–çª—å£ä¸­å¿ƒä½ç½®ï¼ˆè¿›åº¦æ¡é€šå¸¸åœ¨ä¸­ä¸‹éƒ¨ï¼‰
        rect = window.BoundingRectangle
        center_x = (rect.left + rect.right) // 2
        bottom_y = rect.bottom - 30
        
        # é¼ æ ‡ç§»åŠ¨åˆ°è¿›åº¦æ¡ä½ç½®
        pyautogui.moveTo(center_x, bottom_y, duration=0.5)
        time.sleep(1)
        
        # æ°´å¹³ç§»åŠ¨é¼ æ ‡ä»¥è§¦å‘å·¥å…·æç¤º
        for offset in [-50, -30, -10, 0, 10, 30, 50]:
            pyautogui.moveTo(center_x + offset, bottom_y, duration=0.1)
            time.sleep(0.2)
            
            # å°è¯•è·å–å·¥å…·æç¤º
            try:
                for control in auto.GetRootControl().GetChildren():
                    if control.ControlType == auto.ControlType.ToolTipControl:
                        text = control.Name
                        if text and len(text.strip()) &gt; 0:
                            return text
            except:
                pass
    
    return None

if __name__ == "__main__":
    result = get_tooltip_simple()
    print(f"å·¥å…·æç¤ºæ–‡æœ¬: {result}")</code></pre></div><h3><span>5. </span><strong><span>ä½¿ç”¨å¤–éƒ¨å·¥å…·è¾…åŠ©åˆ†æ</span></strong></h3><p class="ds-markdown-paragraph"><span>å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½ä¸è¡Œï¼Œå»ºè®®ï¼š</span></p><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>ä¸‹è½½ Accessible Event Watcher (AccEvent)</span></strong></p><ul><li><p class="ds-markdown-paragraph"><span>å¯ä»¥å®æ—¶ç›‘æ§UIè‡ªåŠ¨åŒ–äº‹ä»¶</span></p></li><li><p class="ds-markdown-paragraph"><span>æŸ¥çœ‹å·¥å…·æç¤ºä½•æ—¶å‡ºç°</span></p></li></ul></li><li><p class="ds-markdown-paragraph"><strong><span>ä½¿ç”¨æ›´ç®€å•çš„æ–¹æ³•ï¼šå±å¹•å–è‰²åˆ¤æ–­</span></strong></p></li></ol><div class="code-block"><pre><code class="language-python"># æ–¹æ³•5ï¼šé€šè¿‡å±å¹•é¢œè‰²åˆ¤æ–­ä½ç½®
import pyautogui
import time

def find_progress_bar_by_color():
    """é€šè¿‡é¢œè‰²ç‰¹å¾æ‰¾åˆ°è¿›åº¦æ¡ä½ç½®"""
    
    # åˆ‡æ¢åˆ°QQéŸ³ä¹
    time.sleep(2)
    
    # æˆªå–å±å¹•
    screenshot = pyautogui.screenshot()
    width, height = screenshot.size
    
    # åœ¨å±å¹•åº•éƒ¨åŒºåŸŸæŸ¥æ‰¾QQéŸ³ä¹çš„è¿›åº¦æ¡
    # QQéŸ³ä¹è¿›åº¦æ¡é€šå¸¸æ˜¯æµ…è“è‰²æˆ–ç»¿è‰²
    progress_colors = [
        (93, 180, 255),   # æµ…è“è‰²
        (0, 197, 93),     # ç»¿è‰²
        (0, 178, 148),    # é’è‰²
    ]
    
    # æ‰«æå±å¹•åº•éƒ¨
    for y in range(height - 100, height - 10):
        for x in range(100, width - 100):
            pixel = screenshot.getpixel((x, y))
            
            # æ£€æŸ¥æ˜¯å¦æ¥è¿‘è¿›åº¦æ¡é¢œè‰²
            for target_color in progress_colors:
                diff = sum(abs(pixel[i] - target_color[i]) for i in range(3))
                if diff &lt; 30:  # é¢œè‰²ç›¸è¿‘
                    print(f"æ‰¾åˆ°å¯èƒ½çš„è¿›åº¦æ¡ä½ç½®: ({x}, {y}), é¢œè‰²: {pixel}")
                    
                    # ç§»åŠ¨é¼ æ ‡åˆ°è¯¥ä½ç½®
                    pyautogui.moveTo(x, y)
                    time.sleep(1)
                    
                    # è¿™é‡Œå¯ä»¥ç»“åˆä¹‹å‰çš„å·¥å…·æç¤ºè·å–æ–¹æ³•
                    return (x, y)
    
    return None</code></pre></div><h2><span>å»ºè®®çš„æµ‹è¯•æ­¥éª¤ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>å…ˆè¿è¡Œç¬¬ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬</span></strong></p><div class="code-block"><pre><code class="language-bash">python method1.py</code></pre></div></li><li><p class="ds-markdown-paragraph"><strong><span>å¦‚æœä¸è¡Œï¼Œä½¿ç”¨ Windows è‡ªå¸¦çš„è®²è¿°äººåŠŸèƒ½æµ‹è¯•</span></strong></p><ul><li><p class="ds-markdown-paragraph"><span>æŒ‰ Win+Ctrl+Enter æ‰“å¼€è®²è¿°äºº</span></p></li><li><p class="ds-markdown-paragraph"><span>å°†é¼ æ ‡ç§»åŠ¨åˆ°QQéŸ³ä¹è¿›åº¦æ¡ä¸Š</span></p></li><li><p class="ds-markdown-paragraph"><span>æŸ¥çœ‹è®²è¿°äººæ˜¯å¦è¯»å‡ºæ—¶é—´ä¿¡æ¯</span></p></li></ul></li><li><p class="ds-markdown-paragraph"><strong><span>æœ€å¯é çš„å¤‡é€‰æ–¹æ¡ˆï¼šOCR</span></strong><span></span><br><span>å¦‚æœè‡ªåŠ¨åŒ–æ–¹æ³•éƒ½ä¸è¡Œï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æˆªå›¾+OCRæ–¹æ¡ˆï¼Œè™½ç„¶æ…¢ä½†æœ€å¯é ã€‚</span></p></li></ol><p class="ds-markdown-paragraph"><span>è¯·å…ˆè¿è¡Œç¬¬ä¸€ä¸ªæ–¹æ³•ï¼Œå‘Šè¯‰æˆ‘ç»“æœå¦‚ä½•ï¼Œæˆ‘å¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µè¿›ä¸€æ­¥è°ƒæ•´ã€‚</span></p></div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">å¯¹äºç¬¬1ä¸ªæ–¹æ³•ï¼Œä¸ç”¨ä½ æ¥ç§»åŠ¨é¼ æ ‡ï¼Œæˆ‘ä¼šæ¥ç§»åŠ¨</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>æ˜ç™½äº†ï¼æˆ‘æ¥ä¿®æ”¹ä»£ç ï¼Œè®©ä½ æ‰‹åŠ¨æ§åˆ¶é¼ æ ‡ç§»åŠ¨ï¼Œç¨‹åºåªè´Ÿè´£æ£€æµ‹å’Œæ˜¾ç¤ºå·¥å…·æç¤ºï¼š</span></p><h2><span>æ–¹æ¡ˆä¸€ï¼šå®æ—¶ç›‘æ§å·¥å…·æç¤ºï¼ˆæ¨èï¼‰</span></h2><div class="code-block"><pre><code class="language-python"># tooltip_monitor.py - å®æ—¶ç›‘æ§å·¥å…·æç¤º
import uiautomation as auto
import time

def monitor_tooltip():
    """å®æ—¶ç›‘æ§å·¥å…·æç¤ºå˜åŒ–"""
    print("=== QQéŸ³ä¹å·¥å…·æç¤ºç›‘æ§å™¨ ===")
    print("ä½¿ç”¨æ–¹æ³•ï¼š")
    print("1. ç¡®ä¿QQéŸ³ä¹æ­£åœ¨è¿è¡Œå¹¶æ’­æ”¾æ­Œæ›²")
    print("2. å°†é¼ æ ‡ç§»åŠ¨åˆ°QQéŸ³ä¹çš„è¿›åº¦æ¡ä¸Š")
    print("3. ç¨‹åºä¼šå®æ—¶æ˜¾ç¤ºå‡ºç°çš„å·¥å…·æç¤ºæ–‡æœ¬")
    print("4. æŒ‰ Ctrl+C åœæ­¢ç›‘æ§\n")
    
    last_text = ""
    check_count = 0
    
    try:
        while True:
            # æŸ¥æ‰¾æ‰€æœ‰å·¥å…·æç¤ºæ§ä»¶
            tooltips = []
            for control in auto.GetRootControl().GetChildren():
                if control.ControlType == auto.ControlType.ToolTipControl:
                    text = control.Name
                    if text and text.strip():
                        tooltips.append((control, text))
            
            # å¦‚æœæœ‰å·¥å…·æç¤ºï¼Œæ˜¾ç¤ºæœ€æ–°çš„
            if tooltips:
                # è·å–æœ€ä¸Šé¢çš„å·¥å…·æç¤ºï¼ˆé€šå¸¸æœ€åä¸€ä¸ªæ˜¯æœ€æ–°çš„ï¼‰
                _, current_text = tooltips[-1]
                
                if current_text != last_text:
                    print(f"ğŸ“Š è¿›åº¦æç¤º: {current_text}")
                    last_text = current_text
            else:
                if last_text:
                    # å·¥å…·æç¤ºæ¶ˆå¤±äº†
                    last_text = ""
            
            # æ¯50æ¯«ç§’æ£€æŸ¥ä¸€æ¬¡
            time.sleep(0.05)
            check_count += 1
            
            # æ¯2ç§’æ˜¾ç¤ºä¸€æ¬¡çŠ¶æ€
            if check_count % 40 == 0:
                print("â³ ç›‘æ§ä¸­... ç§»åŠ¨é¼ æ ‡åˆ°QQéŸ³ä¹è¿›åº¦æ¡ä¸ŠæŸ¥çœ‹æç¤º")
                
    except KeyboardInterrupt:
        print("\nâœ… ç›‘æ§å·²åœæ­¢")

if __name__ == "__main__":
    monitor_tooltip()</code></pre></div><h2><span>æ–¹æ¡ˆäºŒï¼šç®€æ´ç‰ˆï¼Œä»…åœ¨æœ‰å˜åŒ–æ—¶æ˜¾ç¤º</span></h2><div class="code-block"><pre><code class="language-python"># simple_tooltip_detector.py
import uiautomation as auto
import time

def detect_tooltip():
    """æ£€æµ‹å·¥å…·æç¤ºï¼Œåªåœ¨å˜åŒ–æ—¶æ˜¾ç¤º"""
    print("QQéŸ³ä¹è¿›åº¦æç¤ºæ£€æµ‹å™¨")
    print("ç§»åŠ¨é¼ æ ‡åˆ°è¿›åº¦æ¡ä¸Šå³å¯çœ‹åˆ°æ—¶é—´æç¤º")
    print("æŒ‰ Ctrl+C é€€å‡º\n")
    
    last_text = ""
    
    try:
        while True:
            found = False
            
            # éå†æ‰€æœ‰çª—å£æŸ¥æ‰¾å·¥å…·æç¤º
            for window in auto.GetRootControl().GetChildren():
                # æ£€æŸ¥è¿™ä¸ªçª—å£åŠå…¶å­çª—å£ä¸­çš„å·¥å…·æç¤º
                for control in auto.WalkControl(window):
                    if control.ControlType == auto.ControlType.ToolTipControl:
                        text = control.Name
                        if text and text.strip() and text != last_text:
                            print(f"ğŸ•’ {text}")
                            last_text = text
                            found = True
                            break
                if found:
                    break
            
            # å¦‚æœæ²¡æœ‰æ‰¾åˆ°å·¥å…·æç¤ºï¼Œé‡ç½®last_text
            if not found and last_text:
                last_text = ""
            
            time.sleep(0.1)  # é™ä½CPUå ç”¨
            
    except KeyboardInterrupt:
        print("\né€€å‡ºæ£€æµ‹")

if __name__ == "__main__":
    detect_tooltip()</code></pre></div><h2><span>æ–¹æ¡ˆä¸‰ï¼šå¢å¼ºç‰ˆï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯</span></h2><div class="code-block"><pre><code class="language-python"># enhanced_tooltip_detector.py
import uiautomation as auto
import time
from datetime import datetime

class QQMusicTooltipDetector:
    def __init__(self):
        self.last_text = ""
        self.start_time = time.time()
        self.detected_count = 0
        
    def get_current_time(self):
        """è·å–å½“å‰æ—¶é—´å­—ç¬¦ä¸²"""
        return datetime.now().strftime("%H:%M:%S")
    
    def is_qq_music_active(self):
        """æ£€æŸ¥QQéŸ³ä¹æ˜¯å¦æ´»è·ƒ"""
        try:
            foreground = auto.GetForegroundControl()
            window_title = foreground.Name
            
            # QQéŸ³ä¹çª—å£æ ‡é¢˜é€šå¸¸åŒ…å«æ­Œæ›²ä¿¡æ¯
            if window_title and (" - " in window_title or "éŸ³ä¹" in window_title):
                return True
                
            # æˆ–è€…æ£€æŸ¥çª—å£ç±»å
            for window in auto.GetRootControl().GetChildren():
                if window.ClassName == 'TXGuiFoundation':
                    return True
                    
        except:
            pass
        return False
    
    def detect(self):
        """ä¸»æ£€æµ‹å¾ªç¯"""
        print("ğŸµ QQéŸ³ä¹è¿›åº¦æç¤ºæ£€æµ‹å™¨ ğŸµ")
        print("=" * 40)
        print("è¯´æ˜ï¼š")
        print("1. ç¡®ä¿QQéŸ³ä¹æ­£åœ¨æ’­æ”¾æ­Œæ›²")
        print("2. å°†é¼ æ ‡æ‚¬åœåœ¨è¿›åº¦æ¡ä¸Š")
        print("3. ç¨‹åºä¼šè‡ªåŠ¨æ˜¾ç¤ºæ—¶é—´æç¤º")
        print("4. æŒ‰ Ctrl+C é€€å‡ºç¨‹åº")
        print("=" * 40 + "\n")
        
        try:
            while True:
                # æ£€æŸ¥QQéŸ³ä¹æ˜¯å¦æ´»è·ƒ
                if not self.is_qq_music_active():
                    time.sleep(1)
                    continue
                
                # æŸ¥æ‰¾å·¥å…·æç¤º
                tooltip_found = False
                for control in auto.GetRootControl().GetChildren():
                    if control.ControlType == auto.ControlType.ToolTipControl:
                        text = control.Name
                        if text and text.strip():
                            # è¿‡æ»¤æ‰éæ—¶é—´æ ¼å¼çš„æç¤ºï¼ˆQQéŸ³ä¹çš„è¿›åº¦æç¤ºé€šå¸¸åŒ…å«æ–œæ æˆ–å†’å·ï¼‰
                            if '/' in text or ':' in text:
                                if text != self.last_text:
                                    self.detected_count += 1
                                    current_time = self.get_current_time()
                                    print(f"[{current_time}] æ£€æµ‹ #{self.detected_count}: {text}")
                                    self.last_text = text
                                tooltip_found = True
                                break
                
                if not tooltip_found and self.last_text:
                    # å·¥å…·æç¤ºæ¶ˆå¤±äº†
                    self.last_text = ""
                
                time.sleep(0.05)  # å¿«é€Ÿå“åº”
                
        except KeyboardInterrupt:
            elapsed = time.time() - self.start_time
            print(f"\nğŸ“Š ç»Ÿè®¡ä¿¡æ¯:")
            print(f"è¿è¡Œæ—¶é—´: {elapsed:.1f}ç§’")
            print(f"æ£€æµ‹åˆ°æç¤ºæ¬¡æ•°: {self.detected_count}")
            print("ğŸ‘‹ ç¨‹åºå·²é€€å‡º")

def main():
    detector = QQMusicTooltipDetector()
    detector.detect()

if __name__ == "__main__":
    main()</code></pre></div><h2><span>æ–¹æ¡ˆå››ï¼šæœ€å°åŒ–ç‰ˆæœ¬ï¼ˆæœ€ç®€æ´ï¼‰</span></h2><div class="code-block"><pre><code class="language-python"># min_tooltip.py
import uiautomation as auto
import time

last = ""
while True:
    for c in auto.GetRootControl().GetChildren():
        if c.ControlType == auto.ControlType.ToolTipControl:
            t = c.Name
            if t and t != last:
                print(t)
                last = t
    time.sleep(0.05)</code></pre></div><h2><span>ä½¿ç”¨è¯´æ˜ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>é€‰æ‹©ä»»æ„ä¸€ä¸ªç‰ˆæœ¬</span></strong><span>ï¼Œä¿å­˜ä¸º </span><code>.py</code><span> æ–‡ä»¶</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>è¿è¡Œç¨‹åº</span></strong><span>ï¼š</span></p><div class="code-block"><pre><code class="language-bash">python tooltip_monitor.py</code></pre></div></li><li><p class="ds-markdown-paragraph"><strong><span>åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£</span></strong><span>ï¼Œå°†é¼ æ ‡ç§»åŠ¨åˆ°è¿›åº¦æ¡ä¸Š</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>ç¨‹åºä¼šè‡ªåŠ¨æ˜¾ç¤º</span></strong><span>å‡ºç°çš„å·¥å…·æç¤ºæ–‡æœ¬</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>æŒ‰ Ctrl+C</span></strong><span> åœæ­¢ç¨‹åº</span></p></li></ol><h2><span>å¦‚æœä¸Šè¿°æ–¹æ³•æ— æ•ˆçš„å¤‡é€‰æ–¹æ¡ˆï¼š</span></h2><p class="ds-markdown-paragraph"><span>å¦‚æœQQéŸ³ä¹ä½¿ç”¨è‡ªå®šä¹‰ç»˜åˆ¶è€Œä¸æ˜¯æ ‡å‡†å·¥å…·æç¤ºæ§ä»¶ï¼Œå¯ä»¥å°è¯•è¿™ä¸ªç‰ˆæœ¬ï¼š</span></p><div class="code-block"><pre><code class="language-python"># universal_tooltip_detector.py
import uiautomation as auto
import time

def find_all_tooltips():
    """æŸ¥æ‰¾æ‰€æœ‰å¯èƒ½çš„å·¥å…·æç¤ºæ§ä»¶"""
    tooltip_classes = [
        'ToolTip',  # æ ‡å‡†å·¥å…·æç¤º
        'tooltips_class32',  # Windowså·¥å…·æç¤ºç±»
        'TXGuiFoundation',  # QQéŸ³ä¹å¯èƒ½ä½¿ç”¨çš„
        'Qt5QWindowToolSaveBits',  # Qtåº”ç”¨
        'Qt5QWindowIcon',  # Qtåº”ç”¨
    ]
    
    found = []
    
    # æ–¹æ³•1ï¼šæŒ‰æ§ä»¶ç±»å‹æŸ¥æ‰¾
    for control in auto.GetRootControl().GetChildren():
        if control.ControlType == auto.ControlType.ToolTipControl:
            found.append(("ToolTipControl", control.Name))
    
    # æ–¹æ³•2ï¼šæŒ‰ç±»åæŸ¥æ‰¾
    for window in auto.GetRootControl().GetChildren():
        class_name = window.ClassName
        for target_class in tooltip_classes:
            if target_class in class_name:
                text = window.Name
                if text and text.strip():
                    found.append((f"Class: {class_name}", text))
    
    return found

def main():
    print("é€šç”¨å·¥å…·æç¤ºæ£€æµ‹å™¨")
    print("å°è¯•æ£€æµ‹å„ç§ç±»å‹çš„å·¥å…·æç¤º...\n")
    
    last_texts = []
    
    try:
        while True:
            tooltips = find_all_tooltips()
            
            if tooltips and tooltips != last_texts:
                for tooltip_type, text in tooltips:
                    print(f"[{tooltip_type}] {text}")
                last_texts = tooltips
            
            time.sleep(0.1)
            
    except KeyboardInterrupt:
        print("\næ£€æµ‹ç»“æŸ")

if __name__ == "__main__":
    main()</code></pre></div><h2><span>å»ºè®®ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><span>ä»</span><strong><span>æ–¹æ¡ˆä¸€</span></strong><span>å¼€å§‹å°è¯•ï¼Œå®ƒæœ€ç®€å•ç›´æ¥</span></p></li><li><p class="ds-markdown-paragraph"><span>å¦‚æœæ–¹æ¡ˆä¸€æ— æ•ˆï¼Œå°è¯•</span><strong><span>æ–¹æ¡ˆä¸‰</span></strong><span>å¢å¼ºç‰ˆ</span></p></li><li><p class="ds-markdown-paragraph"><span>å¦‚æœéƒ½ä¸è¡Œï¼Œå¯èƒ½æ˜¯QQéŸ³ä¹ä½¿ç”¨äº†ç‰¹æ®Šçš„UIæŠ€æœ¯ï¼Œéœ€è¦æ›´å¤æ‚çš„æ£€æµ‹æ–¹æ³•</span></p></li></ol><p class="ds-markdown-paragraph"><span>è¿è¡Œåè¯·å‘Šè¯‰æˆ‘ç»“æœï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥è°ƒæ•´ä»£ç ä»¥æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚</span></p></div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">éƒ½ä¸è¡Œ</div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">æˆ‘çš„æœ€ç»ˆç›®çš„æ˜¯è·å–è¿™é¦–æ­Œçš„æ‰€æœ‰æ­Œè¯</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>æ˜ç™½äº†ï¼è·å–QQéŸ³ä¹çš„å…¨éƒ¨æ­Œè¯æœ‰æ›´ç›´æ¥çš„æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯å‡ ç§è·å–å…¨éƒ¨æ­Œè¯çš„æ–¹æ¡ˆï¼š</span></p><h2><span>æ–¹æ¡ˆä¸€ï¼šä»QQéŸ³ä¹ç•Œé¢ç›´æ¥è·å–æ­Œè¯</span></h2><div class="code-block"><pre><code class="language-python"># get_all_lyrics.py
import uiautomation as auto
import time

def get_all_lyrics_from_ui():
    """ä»QQéŸ³ä¹ç•Œé¢è·å–å…¨éƒ¨æ­Œè¯"""
    print("æ­£åœ¨ä»QQéŸ³ä¹ç•Œé¢è·å–æ­Œè¯...")
    
    try:
        # æŸ¥æ‰¾QQéŸ³ä¹çª—å£
        window = auto.WindowControl(ClassName='TXGuiFoundation')
        
        if not window.Exists(5, 1):
            print("è¯·å…ˆæ‰“å¼€QQéŸ³ä¹å¹¶æ’­æ”¾æ­Œæ›²")
            return None
        
        print(f"æ‰¾åˆ°QQéŸ³ä¹çª—å£: {window.Name}")
        
        # è·å–æ­Œæ›²ä¿¡æ¯ï¼ˆçª—å£æ ‡é¢˜é€šå¸¸æ˜¯"æ­Œæ›²å - æ­Œæ‰‹"ï¼‰
        window_title = window.Name.strip()
        print(f"å½“å‰æ’­æ”¾: {window_title}")
        
        # å°è¯•æŸ¥æ‰¾æ­Œè¯æ§ä»¶
        # QQéŸ³ä¹çš„æ­Œè¯é€šå¸¸åœ¨ä¸€ä¸ªPaneæˆ–Listæ§ä»¶ä¸­
        
        # æ–¹æ³•1ï¼šæŸ¥æ‰¾æ‰€æœ‰Paneæ§ä»¶
        lyrics_text = ""
        
        for control in window.GetChildren():
            # æ‰“å°æ‰€æœ‰æ§ä»¶ç±»å‹ç”¨äºè°ƒè¯•
            if control.Name and len(control.Name) &gt; 0:
                print(f"[{control.ControlTypeName}] {control.Name[:50]}")
            
            # å¦‚æœæ˜¯åˆ—è¡¨æ§ä»¶ï¼Œå¯èƒ½æ˜¯æ­Œè¯åˆ—è¡¨
            if control.ControlType == auto.ControlType.ListControl:
                print("æ‰¾åˆ°åˆ—è¡¨æ§ä»¶ï¼Œå¯èƒ½æ˜¯æ­Œè¯åˆ—è¡¨")
                # è·å–æ‰€æœ‰åˆ—è¡¨é¡¹
                items = control.GetChildren()
                for item in items:
                    if item.Name:
                        lyrics_text += item.Name + "\n"
        
        # æ–¹æ³•2ï¼šæŸ¥æ‰¾åŒ…å«æ­Œè¯çš„æ–‡æœ¬æ§ä»¶
        if not lyrics_text:
            for control in window.GetChildren():
                if control.ControlType == auto.ControlType.TextControl:
                    text = control.Name
                    if text and len(text) &gt; 0:
                        # å°è¯•åˆ¤æ–­æ˜¯å¦æ˜¯æ­Œè¯ï¼ˆåŒ…å«æ—¶é—´æˆ³ï¼‰
                        if ']' in text or '[' in text or ':' in text:
                            lyrics_text += text + "\n"
        
        # æ–¹æ³•3ï¼šæŸ¥æ‰¾Editæ§ä»¶ï¼ˆå¦‚æœæ­Œè¯å¯ç¼–è¾‘ï¼‰
        if not lyrics_text:
            for control in window.GetChildren():
                if control.ControlType == auto.ControlType.EditControl:
                    text = control.GetValuePattern().Value
                    if text:
                        lyrics_text = text
                        break
        
        if lyrics_text:
            print(f"\nè·å–åˆ°æ­Œè¯ï¼ˆé•¿åº¦: {len(lyrics_text)} å­—ç¬¦ï¼‰:")
            print("-" * 50)
            print(lyrics_text[:500])  # åªæ˜¾ç¤ºå‰500å­—ç¬¦é¢„è§ˆ
            return lyrics_text
        else:
            print("æœªæ‰¾åˆ°æ­Œè¯æ§ä»¶")
            return None
            
    except Exception as e:
        print(f"é”™è¯¯: {e}")
        return None

def save_lyrics_to_file(lyrics, filename=None):
    """ä¿å­˜æ­Œè¯åˆ°æ–‡ä»¶"""
    if not lyrics:
        print("æ²¡æœ‰æ­Œè¯å¯ä¿å­˜")
        return
    
    if not filename:
        # ä½¿ç”¨çª—å£æ ‡é¢˜ä½œä¸ºæ–‡ä»¶å
        window = auto.WindowControl(ClassName='TXGuiFoundation')
        if window.Exists(3, 1):
            title = window.Name.strip()
            # æ¸…ç†æ–‡ä»¶åä¸­çš„éæ³•å­—ç¬¦
            import re
            filename = re.sub(r'[&lt;&gt;:"/\\|?*]', '_', title) + '.lrc'
        else:
            filename = 'lyrics.lrc'
    
    try:
        with open(filename, 'w', encoding='utf-8') as f:
            f.write(lyrics)
        print(f"æ­Œè¯å·²ä¿å­˜åˆ°: {filename}")
        return filename
    except Exception as e:
        print(f"ä¿å­˜å¤±è´¥: {e}")
        return None

if __name__ == "__main__":
    lyrics = get_all_lyrics_from_ui()
    if lyrics:
        save_lyrics_to_file(lyrics)</code></pre></div><h2><span>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨å¿«æ·é”®æ‰“å¼€æ­Œè¯çª—å£å¹¶è·å–</span></h2><div class="code-block"><pre><code class="language-python"># get_lyrics_with_hotkey.py
import uiautomation as auto
import pyautogui
import time

def open_lyrics_window():
    """ä½¿ç”¨å¿«æ·é”®æ‰“å¼€æ­Œè¯çª—å£"""
    print("å°è¯•ä½¿ç”¨å¿«æ·é”®æ‰“å¼€æ­Œè¯çª—å£...")
    
    # æŸ¥æ‰¾QQéŸ³ä¹çª—å£
    window = auto.WindowControl(ClassName='TXGuiFoundation')
    if not window.Exists(5, 1):
        print("QQéŸ³ä¹æœªè¿è¡Œ")
        return False
    
    # æ¿€æ´»çª—å£
    window.SetActive()
    time.sleep(0.5)
    
    # å°è¯•å¸¸ç”¨å¿«æ·é”®
    # Ctrl+L æˆ– F7 æ˜¯QQéŸ³ä¹çš„å¸¸ç”¨æ­Œè¯å¿«æ·é”®
    shortcuts = ['ctrl+l', 'f7', 'ctrl+alt+l']
    
    for shortcut in shortcuts:
        print(f"å°è¯•å¿«æ·é”®: {shortcut}")
        keys = shortcut.split('+')
        pyautogui.hotkey(*keys)
        time.sleep(1)
        
        # æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„æ­Œè¯çª—å£å‡ºç°
        for w in auto.GetRootControl().GetChildren():
            if w.Name and ("æ­Œè¯" in w.Name or "Lyric" in w.Name):
                print(f"æ‰¾åˆ°æ­Œè¯çª—å£: {w.Name}")
                return w
    
    print("æœªæ‰¾åˆ°æ­Œè¯çª—å£")
    return None

def extract_lyrics_from_window(window):
    """ä»æ­Œè¯çª—å£ä¸­æå–æ­Œè¯"""
    lyrics = []
    
    # æ–¹æ³•1ï¼šæŸ¥æ‰¾æ–‡æœ¬æ§ä»¶
    for control in window.GetChildren():
        if control.ControlType in [auto.ControlType.TextControl, 
                                   auto.ControlType.EditControl,
                                   auto.ControlType.DocumentControl]:
            text = control.Name
            if not text and control.ControlType == auto.ControlType.EditControl:
                text = control.GetValuePattern().Value
            
            if text and len(text.strip()) &gt; 0:
                lines = text.split('\n')
                for line in lines:
                    if line.strip():
                        lyrics.append(line.strip())
    
    # æ–¹æ³•2ï¼šå¦‚æœæ˜¯åˆ—è¡¨å½¢å¼
    if not lyrics:
        for control in window.GetChildren():
            if control.ControlType == auto.ControlType.ListControl:
                items = control.GetChildren()
                for item in items:
                    if item.Name:
                        lyrics.append(item.Name)
    
    return '\n'.join(lyrics)

def main():
    print("QQéŸ³ä¹æ­Œè¯è·å–å·¥å…·")
    print("=" * 50)
    
    # å…ˆå°è¯•æ‰“å¼€æ­Œè¯çª—å£
    lyrics_window = open_lyrics_window()
    
    if lyrics_window:
        # ä»æ­Œè¯çª—å£æå–
        lyrics = extract_lyrics_from_window(lyrics_window)
    else:
        # å›é€€åˆ°ç›´æ¥æœç´¢
        print("å°è¯•ä»ä¸»çª—å£æœç´¢æ­Œè¯...")
        lyrics = get_all_lyrics_from_ui()
    
    if lyrics:
        print(f"\nè·å–åˆ° {len(lyrics.splitlines())} è¡Œæ­Œè¯:")
        print("-" * 50)
        print(lyrics[:1000])  # é¢„è§ˆå‰1000å­—ç¬¦
        
        # ä¿å­˜
        save_option = input("\næ˜¯å¦ä¿å­˜æ­Œè¯æ–‡ä»¶ï¼Ÿ(y/n): ").lower()
        if save_option == 'y':
            filename = input("è¯·è¾“å…¥æ–‡ä»¶åï¼ˆç•™ç©ºä½¿ç”¨æ­Œæ›²åï¼‰: ").strip()
            if not filename:
                filename = None
            save_lyrics_to_file(lyrics, filename)
    else:
        print("æœªèƒ½è·å–åˆ°æ­Œè¯")

if __name__ == "__main__":
    main()</code></pre></div><h2><span>æ–¹æ¡ˆä¸‰ï¼šä»ç½‘ç»œAPIè·å–æ­Œè¯ï¼ˆæ›´å¯é ï¼‰</span></h2><div class="code-block"><pre><code class="language-python"># get_lyrics_from_api.py
import requests
import json
import re
from urllib.parse import quote

def search_qq_music_song(song_name):
    """æœç´¢QQéŸ³ä¹æ­Œæ›²"""
    try:
        # ç®€å•æœç´¢APIï¼ˆéå®˜æ–¹ï¼‰
        url = f"https://c.y.qq.com/soso/fcgi-bin/client_search_cp?w={quote(song_name)}&amp;format=json"
        
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Referer': 'https://y.qq.com/'
        }
        
        response = requests.get(url, headers=headers, timeout=10)
        
        if response.status_code == 200:
            # å¤„ç†JSONPæ ¼å¼
            content = response.text
            if content.startswith('callback('):
                content = content[9:-1]  # ç§»é™¤ callback(...) åŒ…è£…
            
            data = json.loads(content)
            
            if 'data' in data and 'song' in data['data'] and 'list' in data['data']['song']:
                songs = data['data']['song']['list']
                if songs:
                    return songs[0]  # è¿”å›ç¬¬ä¸€é¦–åŒ¹é…çš„æ­Œæ›²
                    
    except Exception as e:
        print(f"æœç´¢å¤±è´¥: {e}")
    
    return None

def get_lyrics_by_songmid(songmid):
    """é€šè¿‡songmidè·å–æ­Œè¯"""
    try:
        url = f"https://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric_new.fcg?format=json&amp;nobase64=1&amp;songmid={songmid}"
        
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
            'Referer': 'https://y.qq.com/',
            'Origin': 'https://y.qq.com'
        }
        
        response = requests.get(url, headers=headers, timeout=10)
        
        if response.status_code == 200:
            content = response.text
            # å¤„ç†JSONPæ ¼å¼
            if content.startswith('MusicJsonCallback('):
                content = content[18:-1]
            
            data = json.loads(content)
            
            if 'lyric' in data:
                lyrics = data['lyric']
                # è§£ç Unicodeè½¬ä¹‰åºåˆ—
                lyrics = lyrics.encode('utf-8').decode('unicode_escape')
                return lyrics
                
    except Exception as e:
        print(f"è·å–æ­Œè¯å¤±è´¥: {e}")
    
    return None

def get_current_song_from_window():
    """ä»çª—å£æ ‡é¢˜è·å–å½“å‰æ’­æ”¾æ­Œæ›²"""
    try:
        window = auto.WindowControl(ClassName='TXGuiFoundation')
        if window.Exists(3, 1):
            title = window.Name.strip()
            # å¸¸è§æ ¼å¼: "æ­Œæ›²å - æ­Œæ‰‹"
            if ' - ' in title:
                song_name = title.split(' - ')[0].strip()
                return song_name
            return title
    except:
        pass
    return None

def main():
    print("QQéŸ³ä¹æ­Œè¯è·å–å·¥å…·ï¼ˆç½‘ç»œAPIç‰ˆï¼‰")
    print("=" * 50)
    
    # è·å–å½“å‰æ’­æ”¾çš„æ­Œæ›²
    song_name = get_current_song_from_window()
    
    if not song_name:
        song_name = input("è¯·è¾“å…¥æ­Œæ›²å: ").strip()
    
    if not song_name:
        print("éœ€è¦æ­Œæ›²åæ‰èƒ½æœç´¢")
        return
    
    print(f"æœç´¢æ­Œæ›²: {song_name}")
    
    # æœç´¢æ­Œæ›²
    song_info = search_qq_music_song(song_name)
    
    if song_info:
        print(f"æ‰¾åˆ°æ­Œæ›²: {song_info['songname']} - {song_info['singer'][0]['name']}")
        
        # è·å–æ­Œè¯
        lyrics = get_lyrics_by_songmid(song_info['songmid'])
        
        if lyrics:
            print(f"\nè·å–åˆ°æ­Œè¯ï¼ˆ{len(lyrics)} å­—ç¬¦ï¼‰:")
            print("-" * 50)
            print(lyrics[:1000])  # é¢„è§ˆå‰1000å­—ç¬¦
            
            # ä¿å­˜
            filename = f"{song_info['songname']} - {song_info['singer'][0]['name']}.lrc"
            filename = re.sub(r'[&lt;&gt;:"/\\|?*]', '_', filename)
            
            try:
                with open(filename, 'w', encoding='utf-8') as f:
                    f.write(lyrics)
                print(f"\næ­Œè¯å·²ä¿å­˜åˆ°: {filename}")
            except Exception as e:
                print(f"ä¿å­˜å¤±è´¥: {e}")
        else:
            print("æœªèƒ½è·å–åˆ°æ­Œè¯")
    else:
        print("æœªæ‰¾åˆ°è¯¥æ­Œæ›²")

if __name__ == "__main__":
    main()</code></pre></div><h2><span>æ–¹æ¡ˆå››ï¼šç»“åˆå¤šç§æ–¹æ³•çš„ç»¼åˆå·¥å…·</span></h2><div class="code-block"><pre><code class="language-python"># qq_music_lyrics_tool.py
import uiautomation as auto
import requests
import json
import re
import os
import time
from urllib.parse import quote

class QQMusicLyricsTool:
    def __init__(self):
        self.lyrics = ""
        
    def get_current_song_info(self):
        """è·å–å½“å‰æ’­æ”¾æ­Œæ›²ä¿¡æ¯"""
        try:
            window = auto.WindowControl(ClassName='TXGuiFoundation')
            if window.Exists(3, 1):
                title = window.Name.strip()
                
                # è§£ææ­Œæ›²åå’Œæ­Œæ‰‹
                if ' - ' in title:
                    parts = title.split(' - ')
                    if len(parts) &gt;= 2:
                        song_name = parts[0].strip()
                        artist = parts[1].strip()
                        return {'title': song_name, 'artist': artist, 'full_title': title}
                
                return {'full_title': title}
        except:
            pass
        return None
    
    def try_ui_extraction(self):
        """å°è¯•ä»UIæå–æ­Œè¯"""
        print("å°è¯•ä»UIç•Œé¢æå–æ­Œè¯...")
        
        window = auto.WindowControl(ClassName='TXGuiFoundation')
        if not window.Exists(3, 1):
            return ""
        
        # å°è¯•ä¸åŒçš„æ§ä»¶ç±»å‹
        lyrics_parts = []
        
        # æŸ¥æ‰¾æ‰€æœ‰åŒ…å«æ–‡æœ¬çš„æ§ä»¶
        for control in window.GetChildren():
            try:
                text = ""
                
                if control.Name:
                    text = control.Name
                elif control.ControlType == auto.ControlType.EditControl:
                    text = control.GetValuePattern().Value
                
                if text and len(text.strip()) &gt; 10:  # è‡³å°‘10ä¸ªå­—ç¬¦æ‰å¯èƒ½æ˜¯æ­Œè¯
                    # ç®€å•çš„æ­Œè¯ç‰¹å¾æ£€æµ‹
                    if ('[' in text and ']' in text) or '\n' in text:
                        lyrics_parts.append(text)
            except:
                continue
        
        if lyrics_parts:
            return '\n'.join(lyrics_parts)
        return ""
    
    def search_and_download_lyrics(self, song_name, artist=None):
        """æœç´¢å¹¶ä¸‹è½½æ­Œè¯"""
        print(f"ä»ç½‘ç»œæœç´¢æ­Œè¯: {song_name} {artist if artist else ''}")
        
        # å°è¯•å¤šä¸ªAPIæº
        
        # æº1: QQéŸ³ä¹API
        try:
            search_url = f"https://c.y.qq.com/soso/fcgi-bin/client_search_cp?w={quote(song_name)}&amp;format=json"
            headers = {'User-Agent': 'Mozilla/5.0'}
            
            response = requests.get(search_url, headers=headers, timeout=5)
            
            if response.status_code == 200:
                content = response.text
                if content.startswith('callback('):
                    content = content[9:-1]
                
                data = json.loads(content)
                
                if 'data' in data and 'song' in data['data']:
                    songs = data['data']['song'].get('list', [])
                    
                    for song in songs:
                        # å°è¯•åŒ¹é…æ­Œæ‰‹
                        if artist and 'singer' in song and song['singer']:
                            song_artist = song['singer'][0].get('name', '')
                            if artist.lower() in song_artist.lower() or song_artist.lower() in artist.lower():
                                return self.get_lyrics_by_songmid(song['songmid'])
        
        except:
            pass
        
        # æº2: å¤‡ç”¨API
        try:
            # ä½¿ç”¨ç¬¬ä¸‰æ–¹æ­Œè¯API
            api_url = f"https://api.lyrics.ovh/v1/{quote(artist or '')}/{quote(song_name)}"
            response = requests.get(api_url, timeout=5)
            
            if response.status_code == 200:
                data = response.json()
                if 'lyrics' in data:
                    return data['lyrics']
        except:
            pass
        
        return ""
    
    def get_lyrics_by_songmid(self, songmid):
        """é€šè¿‡songmidè·å–æ­Œè¯"""
        try:
            url = f"https://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric_new.fcg?format=json&amp;nobase64=1&amp;songmid={songmid}"
            headers = {
                'User-Agent': 'Mozilla/5.0',
                'Referer': 'https://y.qq.com/'
            }
            
            response = requests.get(url, headers=headers, timeout=5)
            
            if response.status_code == 200:
                content = response.text
                if content.startswith('MusicJsonCallback('):
                    content = content[18:-1]
                
                data = json.loads(content)
                
                if 'lyric' in data:
                    lyrics = data['lyric']
                    lyrics = lyrics.encode('utf-8').decode('unicode_escape')
                    return lyrics
        except:
            pass
        
        return ""
    
    def get_lyrics(self):
        """ä¸»æ–¹æ³•ï¼šè·å–æ­Œè¯"""
        print("QQéŸ³ä¹æ­Œè¯è·å–å·¥å…·")
        print("=" * 50)
        
        # è·å–å½“å‰æ­Œæ›²ä¿¡æ¯
        song_info = self.get_current_song_info()
        
        if not song_info:
            print("æœªæ£€æµ‹åˆ°QQéŸ³ä¹æ’­æ”¾")
            song_name = input("è¯·è¾“å…¥æ­Œæ›²å: ").strip()
            artist = input("è¯·è¾“å…¥æ­Œæ‰‹ï¼ˆå¯é€‰ï¼‰: ").strip() or None
        else:
            print(f"å½“å‰æ’­æ”¾: {song_info.get('full_title', 'æœªçŸ¥')}")
            song_name = song_info.get('title', song_info.get('full_title', ''))
            artist = song_info.get('artist')
        
        if not song_name:
            print("éœ€è¦æ­Œæ›²å")
            return
        
        # æ–¹æ³•1ï¼šå°è¯•ä»UIè·å–
        self.lyrics = self.try_ui_extraction()
        
        # æ–¹æ³•2ï¼šå¦‚æœUIè·å–å¤±è´¥ï¼Œå°è¯•ç½‘ç»œAPI
        if not self.lyrics or len(self.lyrics.strip()) &lt; 50:
            print("UIè·å–å¤±è´¥æˆ–æ­Œè¯ä¸å®Œæ•´ï¼Œå°è¯•ç½‘ç»œæœç´¢...")
            self.lyrics = self.search_and_download_lyrics(song_name, artist)
        
        if self.lyrics:
            self.save_lyrics(song_name, artist)
        else:
            print("æœªèƒ½è·å–åˆ°æ­Œè¯")
    
    def save_lyrics(self, song_name, artist=None):
        """ä¿å­˜æ­Œè¯åˆ°æ–‡ä»¶"""
        if not self.lyrics:
            return
        
        print(f"\nè·å–åˆ° {len(self.lyrics.splitlines())} è¡Œæ­Œè¯:")
        print("-" * 50)
        print(self.lyrics[:500] + ("..." if len(self.lyrics) &gt; 500 else ""))
        
        # ç”Ÿæˆæ–‡ä»¶å
        if artist:
            filename = f"{song_name} - {artist}.lrc"
        else:
            filename = f"{song_name}.lrc"
        
        # æ¸…ç†éæ³•å­—ç¬¦
        filename = re.sub(r'[&lt;&gt;:"/\\|?*]', '_', filename)
        
        # ä¿å­˜
        try:
            with open(filename, 'w', encoding='utf-8') as f:
                f.write(self.lyrics)
            print(f"\nâœ… æ­Œè¯å·²ä¿å­˜åˆ°: {os.path.abspath(filename)}")
        except Exception as e:
            print(f"ä¿å­˜å¤±è´¥: {e}")

def main():
    tool = QQMusicLyricsTool()
    tool.get_lyrics()

if __name__ == "__main__":
    main()</code></pre></div><h2><span>å®‰è£…ä¾èµ–ï¼š</span></h2><div class="code-block"><pre><code class="language-bash">pip install requests pyautogui</code></pre></div><h2><span>ä½¿ç”¨å»ºè®®ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>é¦–é€‰æ–¹æ¡ˆå››</span></strong><span>ï¼šç»¼åˆå·¥å…·æœ€å¯é ï¼Œä¼šå°è¯•å¤šç§æ–¹æ³•</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>ç½‘ç»œAPIæ–¹æ³•æœ€å¯é </span></strong><span>ï¼šæ–¹æ¡ˆä¸‰å’Œæ–¹æ¡ˆå››çš„ç½‘ç»œAPIæ–¹æ³•é€šå¸¸èƒ½è·å–åˆ°å®Œæ•´çš„LRCæ ¼å¼æ­Œè¯</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>UIæ–¹æ³•æœ‰é™</span></strong><span>ï¼šä»ç•Œé¢è·å–é€šå¸¸åªèƒ½è·å–å½“å‰æ˜¾ç¤ºçš„æ­Œè¯ï¼Œä¸æ˜¯å®Œæ•´æ­Œè¯</span></p></li></ol><h2><span>å¦‚æœæ‰€æœ‰æ–¹æ³•éƒ½å¤±è´¥ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>æ£€æŸ¥ç½‘ç»œè¿æ¥</span></strong><span>ï¼šç½‘ç»œAPIéœ€è¦äº’è”ç½‘è¿æ¥</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>æ‰‹åŠ¨æœç´¢</span></strong><span>ï¼šåœ¨æµè§ˆå™¨ä¸­è®¿é—® </span><a href="https://y.qq.com/" target="_blank" rel="noreferrer"><span>https://y.qq.com/</span></a><span> æœç´¢æ­Œæ›²è·å–æ­Œè¯</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>ä½¿ç”¨ä¸“ä¸šå·¥å…·</span></strong><span>ï¼šå¦‚ LyricEaseã€æ­Œè¯é€‚é…ç­‰ä¸“ä¸šæ­Œè¯ä¸‹è½½å·¥å…·</span></p></li></ol><p class="ds-markdown-paragraph"><span>è¿è¡Œæ–¹æ¡ˆå››çš„å·¥å…·ï¼Œå®ƒä¼šè‡ªåŠ¨å°è¯•å¤šç§æ–¹æ³•è·å–æ­Œè¯ã€‚</span></p></div>
        </div>
</body>
</html>