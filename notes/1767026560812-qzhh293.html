<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è·å–QQéŸ³ä¹è¿›åº¦æ¡æç¤ºæ–‡æœ¬æ–¹æ³• - DeepSeek</title>
  <meta name="created-at" content="1767026560817">
  <meta name="updated-at" content="1767026560817">
  <meta name="source-type" content="deepseek">
  <meta name="source-url" content="https://chat.deepseek.com/a/chat/s/6d42e481-9cd8-4bd6-9595-f62430a5859e">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
      color: #333;
    }
    h1 {
      color: #333;
      border-bottom: 2px solid #10a37f;
      padding-bottom: 10px;
    }
    .message-block {
      margin: 20px 0;
      padding: 16px;
      border-radius: 12px;
    }
    .role-user {
      background: #e8f4fd;
      border-left: 4px solid #3b82f6;
    }
    .role-ai {
      background: #f0fdf4;
      border-left: 4px solid #10b981;
    }
    .message-role {
      font-weight: 700;
      margin-bottom: 8px;
    }
    .role-user .message-role { color: #2563eb; }
    .role-ai .message-role { color: #059669; }
    .message-content {
      line-height: 1.6;
    }
    pre {
      background: #1a1a1a;
      color: #e5e5e5;
      padding: 16px;
      border-radius: 8px;
      overflow-x: auto;
    }
    code {
      font-family: 'Consolas', 'Monaco', monospace;
    }
    img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>è·å–QQéŸ³ä¹è¿›åº¦æ¡æç¤ºæ–‡æœ¬æ–¹æ³• - DeepSeek</h1>
  <div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">æ€ä¹ˆè·å–winç‰ˆqqéŸ³ä¹çš„â€œé¼ æ ‡æ”¾åˆ°æ‹–æ‹½æ¡ä¸Šå‡ºç°çš„æ–¹æ¡†ä¸­çš„æ–‡æœ¬â€å‘¢</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>è·å–QQéŸ³ä¹Windowså®¢æˆ·ç«¯ä¸­è¿›åº¦æ¡æ‚¬åœæç¤ºæ¡†çš„æ–‡æœ¬ï¼Œé€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§æŠ€æœ¯æ–¹æ¡ˆï¼š</span></p><h2><span>ä¸€ã€UIè‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼ˆæ¨èï¼‰</span></h2><h3><span>1. </span><strong><span>ä½¿ç”¨ Accessibility API (UI Automation)</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto

<span class="token comment"># æ‰¾åˆ°QQéŸ³ä¹çª—å£</span>
qq_window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>Name<span class="token operator">=</span><span class="token string">"QQéŸ³ä¹"</span><span class="token punctuation">)</span>
<span class="token comment"># æŸ¥æ‰¾è¿›åº¦æ¡æ§ä»¶ï¼ˆå¯èƒ½éœ€è¦æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´æŸ¥æ‰¾æ¡ä»¶ï¼‰</span>
progress_bar <span class="token operator">=</span> qq_window<span class="token punctuation">.</span>SliderControl<span class="token punctuation">(</span>Name<span class="token operator">=</span><span class="token string">"æ’­æ”¾è¿›åº¦æ¡"</span><span class="token punctuation">)</span>

<span class="token comment"># æ¨¡æ‹Ÿæ‚¬åœ</span>
progress_bar<span class="token punctuation">.</span>Hover<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># è·å–å·¥å…·æç¤ºæ–‡æœ¬</span>
tooltip <span class="token operator">=</span> auto<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">(</span>searchFromControl<span class="token operator">=</span>progress_bar<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>tooltip<span class="token punctuation">.</span>Name<span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>2. </span><strong><span>ä½¿ç”¨ PyWinAuto</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token keyword">from</span> pywinauto <span class="token keyword">import</span> Application
<span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>findwindows <span class="token keyword">import</span> find_window
<span class="token keyword">import</span> time

<span class="token comment"># è¿æ¥åˆ°QQéŸ³ä¹è¿›ç¨‹</span>
app <span class="token operator">=</span> Application<span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">"uia"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"QQéŸ³ä¹"</span><span class="token punctuation">)</span>
window <span class="token operator">=</span> app<span class="token punctuation">.</span>window<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"QQéŸ³ä¹"</span><span class="token punctuation">)</span>

<span class="token comment"># è·å–è¿›åº¦æ¡æ§ä»¶</span>
progress_bar <span class="token operator">=</span> window<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>control_type<span class="token operator">=</span><span class="token string">"ProgressBar"</span><span class="token punctuation">)</span>

<span class="token comment"># è·å–ä½ç½®å¹¶æ¨¡æ‹Ÿé¼ æ ‡æ‚¬åœ</span>
rect <span class="token operator">=</span> progress_bar<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>left <span class="token operator">+</span> rect<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
y <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>top <span class="token operator">+</span> rect<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>

<span class="token comment"># å¯èƒ½éœ€è¦è§¦å‘æ‚¬åœäº‹ä»¶</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>äºŒã€Windows APIæ–¹æ¡ˆ</span></h2><h3><span>3. </span><strong><span>ä½¿ç”¨ Win32 API è·å–å·¥å…·æç¤º</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">csharp</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment">// C# ç¤ºä¾‹</span>
<span class="token punctuation">[</span><span class="token function">DllImport</span><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name">IntPtr</span> <span class="token function">WindowFromPoint</span><span class="token punctuation">(</span><span class="token class-name">POINT</span> point<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">DllImport</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"user32.dll"</span><span class="token punctuation">,</span> CharSet <span class="token operator">=</span> CharSet<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">static</span> <span class="token keyword">extern</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">GetWindowText</span><span class="token punctuation">(</span><span class="token class-name">IntPtr</span> hWnd<span class="token punctuation">,</span> <span class="token class-name">StringBuilder</span> text<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è·å–é¼ æ ‡ä½ç½®ä¸‹çš„çª—å£å¥æŸ„ï¼Œç„¶åè·å–æ–‡æœ¬</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>ä¸‰ã€é€†å‘å·¥ç¨‹æ–¹æ¡ˆï¼ˆé«˜çº§ï¼‰</span></h2><h3><span>4. </span><strong><span>å†…å­˜è¯»å–</span></strong></h3><ul><li><p class="ds-markdown-paragraph"><span>ä½¿ç”¨ Cheat Engine ç­‰å·¥å…·åˆ†æQQéŸ³ä¹è¿›ç¨‹</span></p></li><li><p class="ds-markdown-paragraph"><span>å®šä½å­˜å‚¨è¿›åº¦æ—¶é—´æ–‡æœ¬çš„å†…å­˜åœ°å€</span></p></li><li><p class="ds-markdown-paragraph"><span>é€šè¿‡è¿›ç¨‹æ³¨å…¥è¯»å–å†…å­˜æ•°æ®</span></p></li></ul><h3><span>5. </span><strong><span>DLLæ³¨å…¥ + Hook</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">cpp</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment">// Hook ç»˜åˆ¶æ–‡æœ¬çš„å‡½æ•°ï¼ˆå¦‚DrawTextã€TextOutç­‰ï¼‰</span>
<span class="token comment">// æ‹¦æˆªå¹¶è®°å½•ç»˜åˆ¶å†…å®¹</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>å››ã€OCRæ–¹æ¡ˆï¼ˆé€šç”¨ä½†è¾ƒæ…¢ï¼‰</span></h2><h3><span>6. </span><strong><span>å±å¹•æˆªå›¾ + OCRè¯†åˆ«</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token keyword">import</span> pyautogui
<span class="token keyword">import</span> pytesseract
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token comment"># 1. æ¨¡æ‹Ÿé¼ æ ‡æ‚¬åœåœ¨è¿›åº¦æ¡ä¸Š</span>
<span class="token comment"># 2. æˆªå–å·¥å…·æç¤ºåŒºåŸŸ</span>
<span class="token comment"># 3. ä½¿ç”¨OCRè¯†åˆ«æ–‡æœ¬</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>äº”ã€æ³¨æ„äº‹é¡¹</span></h2><h3><span>âš ï¸ </span><strong><span>é‡è¦æé†’</span></strong><span>ï¼š</span></h3><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>åˆæ³•æ€§å’Œç”¨æˆ·åè®®</span></strong><span>ï¼šQQéŸ³ä¹å¯èƒ½æœ‰ç¦æ­¢è‡ªåŠ¨åŒ–æ“ä½œçš„ç”¨æˆ·åè®®æ¡æ¬¾</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>æŠ€æœ¯éš¾åº¦</span></strong><span>ï¼šQQéŸ³ä¹å¯èƒ½ä½¿ç”¨äº†è‡ªå®šä¹‰æ§ä»¶ï¼Œæ ‡å‡†UIè‡ªåŠ¨åŒ–å¯èƒ½æ— æ³•ç›´æ¥è·å–</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>æ›´æ–°å…¼å®¹æ€§</span></strong><span>ï¼šå®¢æˆ·ç«¯æ›´æ–°å¯èƒ½å¯¼è‡´ä»£ç å¤±æ•ˆ</span></p></li></ol><h3><span>ğŸ“ </span><strong><span>å»ºè®®æ–¹æ¡ˆ</span></strong><span>ï¼š</span></h3><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>ä¼˜å…ˆå°è¯•UI Automationæ–¹æ¡ˆ</span></strong><span>ï¼Œè¿™æ˜¯æœ€æ ‡å‡†çš„Windowsè‡ªåŠ¨åŒ–æ–¹æ³•</span></p></li><li><p class="ds-markdown-paragraph"><span>å¦‚æœæ— æ³•ç›´æ¥è·å–ï¼Œå¯ä»¥å°è¯•</span><strong><span>ä½¿ç”¨Accessibility Insightså·¥å…·</span></strong><span>å…ˆåˆ†ææ§ä»¶ç»“æ„</span></p></li><li><p class="ds-markdown-paragraph"><span>å¯¹äºä¸ªäººå­¦ä¹ ä½¿ç”¨ï¼Œå¯ä»¥è€ƒè™‘OCRæ–¹æ¡ˆï¼Œè™½ç„¶è¾ƒæ…¢ä½†æœ€é€šç”¨</span></p></li></ol><h3><span>ğŸ”§ </span><strong><span>è°ƒè¯•å·¥å…·æ¨è</span></strong><span>ï¼š</span></h3><ul><li><p class="ds-markdown-paragraph"><strong><span>Accessibility Insights</span></strong><span>ï¼šåˆ†æUIæ§ä»¶ç»“æ„</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>Spy++</span></strong><span>ï¼šæŸ¥çœ‹çª—å£æ¶ˆæ¯å’Œå±æ€§</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>AutoHotkey</span></strong><span>ï¼šå¿«é€Ÿç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬</span></p></li></ul><p class="ds-markdown-paragraph"><span>éœ€è¦æ ¹æ®ä½ çš„å…·ä½“ä½¿ç”¨åœºæ™¯ï¼ˆè‡ªåŠ¨åŒ–æµ‹è¯•ã€è¾…åŠ©å·¥å…·ã€ä¸ªäººå­¦ä¹ ç­‰ï¼‰é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆã€‚å¦‚æœæ˜¯å•†ä¸šç”¨é€”ï¼Œè¯·åŠ¡å¿…éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œè½¯ä»¶è®¸å¯åè®®ã€‚</span></p></div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">UIæ–¹æ¡ˆä¸¤ä¸ªéƒ½æŠ¥é”™äº†ï¼š
î‚¶î˜ª jewel@TOKî‚´ D:\..î—¾..\HaloPixelToolBoxî‚´ îœ¥ mainî‚´ python .\q.py
Traceback (most recent call last):
  File "D:\software\HaloPixelToolBox\q.py", line 9, in &lt;module&gt;
    progress_bar.Hover()
    ^^^^^^^^^^^^^^^^^^
AttributeError: 'SliderControl' object has no attribute 'Hover'
î‚¶î˜ª jewel@TOKî‚´ D:\..î—¾..\HaloPixelToolBoxî‚´ îœ¥ mainî‚´ python .\q.py
Traceback (most recent call last):
  File "D:\software\HaloPixelToolBox\q.py", line 6, in &lt;module&gt;
    app = Application(backend="uia").connect(title="QQéŸ³ä¹")
          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "D:\Program Files\python314\Lib\site-packages\pywinauto\application.py", line 997, in connect
    self.process = findwindows.find_element(**kwargs).process_id
                   ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "D:\Program Files\python314\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'QQéŸ³ä¹', 'backend': 'uia', 'visible_only': False}</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>è¿™ä¸ªé”™è¯¯è¡¨æ˜æˆ‘ä»¬éœ€è¦è°ƒæ•´æ–¹æ³•æ¥æ­£ç¡®æ“ä½œQQéŸ³ä¹çš„æ§ä»¶ã€‚è®©æˆ‘æä¾›ä¿®æ­£åçš„ä»£ç å’Œè°ƒè¯•æ–¹æ³•ï¼š</span></p><h2><span>ä¸€ã€è°ƒè¯•å’Œä¿®æ­£</span></h2><h3><span>1. </span><strong><span>è°ƒè¯•QQéŸ³ä¹çª—å£ç»“æ„</span></strong></h3><p class="ds-markdown-paragraph"><span>é¦–å…ˆæŸ¥çœ‹QQéŸ³ä¹çš„çª—å£ç»“æ„ï¼š</span></p><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># debug_window.py - è°ƒè¯•QQéŸ³ä¹çª—å£ç»“æ„</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

<span class="token comment"># åˆ—å‡ºæ‰€æœ‰é¡¶çº§çª—å£</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== æ‰€æœ‰é¡¶çº§çª—å£ ==="</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> window <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> window<span class="token punctuation">.</span>Name<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"çª—å£: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string"> (ç±»å: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>ClassName<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>

<span class="token comment"># æŸ¥æ‰¾åŒ…å«"QQéŸ³ä¹"çš„çª—å£</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n=== æŸ¥æ‰¾QQéŸ³ä¹ç›¸å…³çª—å£ ==="</span><span class="token punctuation">)</span>
qq_windows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> window <span class="token keyword">in</span> auto<span class="token punctuation">.</span>WalkControl<span class="token punctuation">(</span>auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">"QQéŸ³ä¹"</span> <span class="token keyword">in</span> window<span class="token punctuation">.</span>Name<span class="token punctuation">:</span>
        qq_windows<span class="token punctuation">.</span>append<span class="token punctuation">(</span>window<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°çª—å£: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">, ç±»å: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>ClassName<span class="token punctuation">}</span></span><span class="token string">, ControlType: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>ControlTypeName<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># æˆ–è€…ä½¿ç”¨æ›´ç®€å•çš„æ–¹æ³•æŸ¥æ‰¾</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n=== å°è¯•ç›´æ¥æŸ¥æ‰¾ ==="</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£</span>
window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>searchDepth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">,</span> Name<span class="token operator">=</span><span class="token string">'QQéŸ³ä¹'</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ‰¾åˆ°ä¸»çª—å£"</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>SetActive<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># æ‰“å°çª—å£çš„æ‰€æœ‰å­æ§ä»¶</span>
    <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ§ä»¶: </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>ControlTypeName<span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>2. </span><strong><span>æ­£ç¡®çš„è¿›åº¦æ¡æ‚¬åœæ–¹æ³•</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># qq_music_tooltip.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">get_qq_music_tooltip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""è·å–QQéŸ³ä¹è¿›åº¦æ¡æ‚¬åœæç¤º"""</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># æ–¹æ³•1ï¼šé€šè¿‡è¿›ç¨‹åæŸ¥æ‰¾</span>
        <span class="token comment"># app = auto.Application(executable_path='QQMusic.exe')</span>
        <span class="token comment"># window = app.WindowControl(Name='QQéŸ³ä¹')</span>
        
        <span class="token comment"># æ–¹æ³•2ï¼šç›´æ¥æŸ¥æ‰¾çª—å£ï¼ˆQQéŸ³ä¹é€šå¸¸ä½¿ç”¨è¿™ä¸ªç±»åï¼‰</span>
        window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>
            searchDepth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> 
            ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">,</span> 
            Name<span class="token operator">=</span><span class="token string">'QQéŸ³ä¹'</span>
        <span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªæ‰¾åˆ°QQéŸ³ä¹çª—å£ï¼Œè¯·ç¡®ä¿QQéŸ³ä¹æ­£åœ¨è¿è¡Œ"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ‰¾åˆ°QQéŸ³ä¹çª—å£"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># æŸ¥æ‰¾æ‰€æœ‰è¿›åº¦æ¡æˆ–æ»‘å—æ§ä»¶</span>
        sliders <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> ctrl <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> ctrl<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>SliderControl<span class="token punctuation">:</span>
                sliders<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ctrl<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°æ»‘å—: </span><span class="token interpolation"><span class="token punctuation">{</span>ctrl<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> sliders<span class="token punctuation">:</span>
            <span class="token comment"># å°è¯•é€šè¿‡æ–‡æœ¬æŸ¥æ‰¾</span>
            progress_bars <span class="token operator">=</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'msctls_progress32'</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°è¿›åº¦æ¡æ•°é‡: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>progress_bars<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ¨¡æ‹Ÿé¼ æ ‡ç§»åŠ¨åˆ°è¿›åº¦æ¡ä¸Š</span>
        <span class="token comment"># å…ˆå°è¯•è·å–çª—å£ä½ç½®</span>
        rect <span class="token operator">=</span> window<span class="token punctuation">.</span>BoundingRectangle
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"çª—å£ä½ç½®: </span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># å‡è®¾è¿›åº¦æ¡åœ¨çª—å£ä¸­é—´åä¸‹çš„ä½ç½®</span>
        <span class="token comment"># QQéŸ³ä¹çš„è¿›åº¦æ¡é€šå¸¸åœ¨åº•éƒ¨</span>
        progress_bar_y <span class="token operator">=</span> rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> <span class="token number">50</span>  <span class="token comment"># è·åº•éƒ¨50åƒç´ </span>
        progress_bar_x <span class="token operator">=</span> rect<span class="token punctuation">.</span>left <span class="token operator">+</span> <span class="token number">200</span>   <span class="token comment"># ä»å·¦è¾¹200åƒç´ å¼€å§‹</span>
        
        <span class="token comment"># ç§»åŠ¨é¼ æ ‡åˆ°è¿›åº¦æ¡ä¸Šï¼ˆæµ‹è¯•ä¸åŒä½ç½®ï¼‰</span>
        <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>progress_bar_x<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>right <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            auto<span class="token punctuation">.</span>SetCursorPos<span class="token punctuation">(</span>x<span class="token punctuation">,</span> progress_bar_y<span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
            
            <span class="token comment"># æŸ¥æ‰¾å‡ºç°çš„å·¥å…·æç¤ºçª—å£</span>
            tooltips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> tip <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> tip<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">:</span>
                    tooltips<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tip<span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°å·¥å…·æç¤º: </span><span class="token interpolation"><span class="token punctuation">{</span>tip<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> tooltips<span class="token punctuation">:</span>
                <span class="token keyword">return</span> tooltips<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Name
        
        <span class="token keyword">return</span> <span class="token boolean">None</span>
        
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"é”™è¯¯: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">import</span> traceback
        traceback<span class="token punctuation">.</span>print_exc<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> get_qq_music_tooltip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è·å–åˆ°çš„æç¤ºæ–‡æœ¬: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>3. </span><strong><span>ä½¿ç”¨æ§ä»¶çš„ç›¸å¯¹åæ ‡</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># qq_music_detailed.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">find_and_hover_progress_bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""æ›´ç²¾ç¡®åœ°æŸ¥æ‰¾å’Œæ‚¬åœè¿›åº¦æ¡"""</span>
    
    <span class="token comment"># æŸ¥æ‰¾QQéŸ³ä¹ä¸»çª—å£</span>
    window <span class="token operator">=</span> auto<span class="token punctuation">.</span>PaneControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">,</span> Name<span class="token operator">=</span><span class="token string">'QQéŸ³ä¹'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¯·å…ˆå¯åŠ¨QQéŸ³ä¹"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"QQéŸ³ä¹çª—å£å·²æ‰¾åˆ°"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># æœ€å°åŒ–å†æ¢å¤ä»¥æ¿€æ´»çª—å£</span>
    window<span class="token punctuation">.</span>SetFocus<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    
    <span class="token comment"># ä½¿ç”¨Inspectå·¥å…·æŸ¥çœ‹çš„å…·ä½“æ§ä»¶ä¿¡æ¯</span>
    <span class="token comment"># QQéŸ³ä¹å¯èƒ½ä½¿ç”¨è‡ªå®šä¹‰æ§ä»¶ï¼Œå°è¯•ä¸åŒæ–¹æ³•</span>
    
    <span class="token comment"># æ–¹æ³•1ï¼šé€šè¿‡åç§°æŸ¥æ‰¾æ’­æ”¾æ§åˆ¶åŒºåŸŸ</span>
    playback_area <span class="token operator">=</span> window<span class="token punctuation">.</span>PaneControl<span class="token punctuation">(</span>Name<span class="token operator">=</span><span class="token string">'æ’­æ”¾æ§åˆ¶åŒºåŸŸ'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># æ–¹æ³•2ï¼šæŸ¥æ‰¾åŒ…å«æ—¶é—´æ˜¾ç¤ºçš„æ§ä»¶</span>
    <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        control_type <span class="token operator">=</span> control<span class="token punctuation">.</span>ControlTypeName
        name <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
        
        <span class="token comment"># è¾“å‡ºæœ‰ç”¨çš„æ§ä»¶ä¿¡æ¯ç”¨äºè°ƒè¯•</span>
        <span class="token keyword">if</span> name <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[</span><span class="token interpolation"><span class="token punctuation">{</span>control_type<span class="token punctuation">}</span></span><span class="token string">] </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
            <span class="token comment"># æ—¶é—´ç›¸å…³çš„æ§ä»¶</span>
            <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>time_keyword <span class="token keyword">in</span> name <span class="token keyword">for</span> time_keyword <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'æ’­æ”¾'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  å¯èƒ½ç›¸å…³: </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                
                <span class="token comment"># è·å–ä½ç½®ä¿¡æ¯</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    rect <span class="token operator">=</span> control<span class="token punctuation">.</span>BoundingRectangle
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  ä½ç½®: (</span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">.</span>left<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">.</span>top<span class="token punctuation">}</span></span><span class="token string">) - (</span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">.</span>right<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">.</span>bottom<span class="token punctuation">}</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>
                    
                    <span class="token comment"># å¦‚æœæ˜¯è¿›åº¦æ¡æˆ–æ»‘å—</span>
                    <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>SliderControl<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"  è¿™æ˜¯ä¸€ä¸ªæ»‘å—æ§ä»¶"</span><span class="token punctuation">)</span>
                        
                        <span class="token comment"># è·å–è¿›åº¦æ¡ç›¸å…³ä¿¡æ¯</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  å€¼: </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>GetValuePattern<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  èŒƒå›´: </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>GetRangeValuePattern<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Minimum<span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>GetRangeValuePattern<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Maximum<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        
                        <span class="token comment"># ç§»åŠ¨åˆ°æ§ä»¶ä¸­å¿ƒ</span>
                        center_x <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>left <span class="token operator">+</span> rect<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
                        center_y <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>top <span class="token operator">+</span> rect<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
                        
                        <span class="token comment"># æ¨¡æ‹Ÿæ‚¬åœ</span>
                        auto<span class="token punctuation">.</span>SetCursorPos<span class="token punctuation">(</span>center_x<span class="token punctuation">,</span> center_y<span class="token punctuation">)</span>
                        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                        
                        <span class="token comment"># æŸ¥æ‰¾å·¥å…·æç¤º</span>
                        tooltip <span class="token operator">=</span> auto<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token keyword">if</span> tooltip<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"  å·¥å…·æç¤º: </span><span class="token interpolation"><span class="token punctuation">{</span>tooltip<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                            <span class="token keyword">return</span> tooltip<span class="token punctuation">.</span>Name
                <span class="token keyword">except</span><span class="token punctuation">:</span>
                    <span class="token keyword">pass</span>
    
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> find_and_hover_progress_bar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ç»“æœ: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>4. </span><strong><span>ä½¿ç”¨æ›´ç›´æ¥çš„é¼ æ ‡æ¨¡æ‹Ÿ</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># mouse_simulation.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time
<span class="token keyword">import</span> pyautogui

<span class="token keyword">def</span> <span class="token function">get_tooltip_by_mouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""é€šè¿‡é¼ æ ‡æ¨¡æ‹Ÿè·å–å·¥å…·æç¤º"""</span>
    
    <span class="token comment"># æŸ¥æ‰¾çª—å£</span>
    window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">,</span> Name<span class="token operator">=</span><span class="token string">'QQéŸ³ä¹'</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"QQéŸ³ä¹æœªè¿è¡Œ"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    
    <span class="token comment"># æ¿€æ´»çª—å£</span>
    window<span class="token punctuation">.</span>SetActive<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    
    <span class="token comment"># è·å–çª—å£ä½ç½®</span>
    rect <span class="token operator">=</span> window<span class="token punctuation">.</span>BoundingRectangle
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"çª—å£ä½ç½®: </span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token comment"># åœ¨çª—å£å†…æŸ¥æ‰¾å¯èƒ½çš„è¿›åº¦æ¡åŒºåŸŸ</span>
    <span class="token comment"># QQéŸ³ä¹è¿›åº¦æ¡é€šå¸¸åœ¨çª—å£åº•éƒ¨ä¸­é—´ä½ç½®</span>
    
    <span class="token comment"># æ–¹æ³•1ï¼šä»ä¸‹å¾€ä¸Šæ‰«æ</span>
    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">,</span> rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>left <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">,</span> rect<span class="token punctuation">.</span>right <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># ç§»åŠ¨é¼ æ ‡</span>
            pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> duration<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
            
            <span class="token comment"># æŸ¥æ‰¾å·¥å…·æç¤º</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                tooltip <span class="token operator">=</span> auto<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> tooltip<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    text <span class="token operator">=</span> tooltip<span class="token punctuation">.</span>Name
                    <span class="token keyword">if</span> text <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"åœ¨ä½ç½® (</span><span class="token interpolation"><span class="token punctuation">{</span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>y<span class="token punctuation">}</span></span><span class="token string">) æ‰¾åˆ°æç¤º: </span><span class="token interpolation"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> text
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
    
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># å…ˆåˆ‡æ¢åˆ°QQéŸ³ä¹</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"5ç§’å†…è¯·åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£..."</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    
    result <span class="token operator">=</span> get_tooltip_by_mouse<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æœ€ç»ˆç»“æœ: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>5. </span><strong><span>ä½¿ç”¨æ›´é«˜çº§çš„å·¥å…·åˆ†æ</span></strong></h3><p class="ds-markdown-paragraph"><span>å¦‚æœä¸Šè¿°æ–¹æ³•éƒ½ä¸è¡Œï¼Œå»ºè®®ä½¿ç”¨ä¸“é—¨çš„UIåˆ†æå·¥å…·ï¼š</span></p><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>Accessibility Insights for Windows</span></strong></p><ul><li><p class="ds-markdown-paragraph"><span>ä¸‹è½½å¹¶è¿è¡Œ</span></p></li><li><p class="ds-markdown-paragraph"><span>ä½¿ç”¨"FastPass"æ¨¡å¼æ‰«æQQéŸ³ä¹çª—å£</span></p></li><li><p class="ds-markdown-paragraph"><span>æŸ¥çœ‹æ§ä»¶çš„å®Œæ•´å±æ€§å’Œç»“æ„</span></p></li></ul></li><li><p class="ds-markdown-paragraph"><strong><span>ä½¿ç”¨ Spy++ (Visual Studio é™„å¸¦)</span></strong></p><ul><li><p class="ds-markdown-paragraph"><span>å¯ä»¥æŸ¥çœ‹çª—å£æ¶ˆæ¯å’Œå±‚çº§ç»“æ„</span></p></li></ul></li><li><p class="ds-markdown-paragraph"><strong><span>åˆ›å»ºè‡ªåŠ¨åŒ–è¾…åŠ©å·¥å…·</span></strong></p></li></ol><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># ui_explorer.py - æ¢ç´¢UIç»“æ„</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto

<span class="token keyword">def</span> <span class="token function">explore_controls</span><span class="token punctuation">(</span>control<span class="token punctuation">,</span> depth<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> max_depth<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""é€’å½’æ¢ç´¢æ§ä»¶æ ‘"""</span>
    <span class="token keyword">if</span> depth <span class="token operator">&gt;</span> max_depth<span class="token punctuation">:</span>
        <span class="token keyword">return</span>
    
    indent <span class="token operator">=</span> <span class="token string">"  "</span> <span class="token operator">*</span> depth
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        name <span class="token operator">=</span> control<span class="token punctuation">.</span>Name <span class="token keyword">if</span> control<span class="token punctuation">.</span>Name <span class="token keyword">else</span> <span class="token string">""</span>
        control_type <span class="token operator">=</span> control<span class="token punctuation">.</span>ControlTypeName
        
        <span class="token comment"># åªæ˜¾ç¤ºæœ‰åç§°æˆ–ç‰¹å®šç±»å‹çš„æ§ä»¶</span>
        <span class="token keyword">if</span> name <span class="token keyword">or</span> control_type <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"SliderControl"</span><span class="token punctuation">,</span> <span class="token string">"ProgressBarControl"</span><span class="token punctuation">,</span> <span class="token string">"ToolTipControl"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>indent<span class="token punctuation">}</span></span><span class="token string">[</span><span class="token interpolation"><span class="token punctuation">{</span>control_type<span class="token punctuation">}</span></span><span class="token string">] </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
            <span class="token comment"># å¦‚æœæ˜¯å·¥å…·æç¤ºï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯</span>
            <span class="token keyword">if</span> control_type <span class="token operator">==</span> <span class="token string">"ToolTipControl"</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>indent<span class="token punctuation">}</span></span><span class="token string">  æ–‡æœ¬: </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                rect <span class="token operator">=</span> control<span class="token punctuation">.</span>BoundingRectangle
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>indent<span class="token punctuation">}</span></span><span class="token string">  ä½ç½®: </span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># é€’å½’å­æ§ä»¶</span>
        <span class="token keyword">for</span> child <span class="token keyword">in</span> control<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            explore_controls<span class="token punctuation">(</span>child<span class="token punctuation">,</span> depth <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> max_depth<span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token comment"># æŸ¥æ‰¾QQéŸ³ä¹çª—å£å¹¶æ¢ç´¢</span>
window <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">for</span> w <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> w<span class="token punctuation">.</span>Name <span class="token keyword">and</span> <span class="token string">"QQéŸ³ä¹"</span> <span class="token keyword">in</span> w<span class="token punctuation">.</span>Name<span class="token punctuation">:</span>
        window <span class="token operator">=</span> w
        <span class="token keyword">break</span>

<span class="token keyword">if</span> window<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ¢ç´¢çª—å£: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    explore_controls<span class="token punctuation">(</span>window<span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªæ‰¾åˆ°QQéŸ³ä¹çª—å£"</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>6. </span><strong><span>ä½¿ç”¨OCRä½œä¸ºå¤‡é€‰æ–¹æ¡ˆ</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># ocr_tooltip.py</span>
<span class="token keyword">import</span> pyautogui
<span class="token keyword">import</span> pytesseract
<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token punctuation">,</span> ImageGrab
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">capture_and_ocr_tooltip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""é€šè¿‡æˆªå›¾å’ŒOCRè¯†åˆ«å·¥å…·æç¤º"""</span>
    
    <span class="token comment"># ç¡®ä¿QQéŸ³ä¹åœ¨å‰å°</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¯·åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£..."</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    
    <span class="token comment"># è·å–å±å¹•å°ºå¯¸</span>
    screen_width<span class="token punctuation">,</span> screen_height <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># åœ¨é¼ æ ‡ä½ç½®é™„è¿‘æˆªå–å°åŒºåŸŸ</span>
    mouse_x<span class="token punctuation">,</span> mouse_y <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>position<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># è®¡ç®—æˆªå›¾åŒºåŸŸï¼ˆé¼ æ ‡ä¸Šæ–¹çš„å°åŒºåŸŸï¼‰</span>
    capture_area <span class="token operator">=</span> <span class="token punctuation">(</span>
        mouse_x <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">,</span> mouse_y <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">,</span>  <span class="token comment"># å·¦ä¸Šè§’</span>
        mouse_x <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">,</span> mouse_y <span class="token operator">+</span> <span class="token number">10</span>   <span class="token comment"># å³ä¸‹è§’</span>
    <span class="token punctuation">)</span>
    
    <span class="token comment"># æˆªå›¾</span>
    screenshot <span class="token operator">=</span> ImageGrab<span class="token punctuation">.</span>grab<span class="token punctuation">(</span>bbox<span class="token operator">=</span>capture_area<span class="token punctuation">)</span>
    
    <span class="token comment"># ä¿å­˜æˆªå›¾ç”¨äºè°ƒè¯•</span>
    screenshot<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"tooltip_screenshot.png"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># ä½¿ç”¨OCRè¯†åˆ«</span>
    text <span class="token operator">=</span> pytesseract<span class="token punctuation">.</span>image_to_string<span class="token punctuation">(</span>screenshot<span class="token punctuation">,</span> lang<span class="token operator">=</span><span class="token string">'chi_sim'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># æ¸…ç†æ–‡æœ¬</span>
    text <span class="token operator">=</span> text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> text<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è¯†åˆ«åˆ°çš„æ–‡æœ¬: </span><span class="token interpolation"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> text
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªè¯†åˆ«åˆ°æ–‡æœ¬"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># å…ˆç§»åŠ¨é¼ æ ‡åˆ°è¿›åº¦æ¡ä¸Š</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"5ç§’å†…è¯·å°†é¼ æ ‡ç§»åŠ¨åˆ°QQéŸ³ä¹è¿›åº¦æ¡ä¸Š..."</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    
    <span class="token comment"># ç¨ç­‰è®©å·¥å…·æç¤ºå‡ºç°</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    
    result <span class="token operator">=</span> capture_and_ocr_tooltip<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>äºŒã€å»ºè®®çš„è°ƒè¯•æ­¥éª¤</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>å…ˆè¿è¡Œ </span><code>debug_window.py</code></strong><span> æŸ¥çœ‹QQéŸ³ä¹çš„çª—å£ç»“æ„</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>ä½¿ç”¨Accessibility Insightså·¥å…·</span></strong><span> åˆ†æå…·ä½“çš„æ§ä»¶å±æ€§</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>è°ƒæ•´æ§ä»¶æŸ¥æ‰¾æ¡ä»¶</span></strong><span> æ ¹æ®å®é™…çœ‹åˆ°çš„å±æ€§ä¿®æ”¹ä»£ç </span></p></li><li><p class="ds-markdown-paragraph"><strong><span>å°è¯•ä¸åŒçš„é¼ æ ‡ä½ç½®</span></strong><span> QQéŸ³ä¹çš„UIå¯èƒ½æ¯”è¾ƒå¤æ‚</span></p></li></ol><p class="ds-markdown-paragraph"><span>å¦‚æœè¿™äº›æ–¹æ³•éƒ½ä¸è¡Œï¼Œå¯èƒ½éœ€è¦è€ƒè™‘QQéŸ³ä¹ä½¿ç”¨äº†ç‰¹æ®Šçš„UIæ¡†æ¶ï¼ˆå¦‚Qtã€Electronç­‰ï¼‰ï¼Œéœ€è¦ä¸“é—¨çš„è‡ªåŠ¨åŒ–æ–¹æ³•ã€‚è¯·å‘Šè¯‰æˆ‘ä½ è¿è¡Œè°ƒè¯•è„šæœ¬çš„å…·ä½“ç»“æœï¼Œæˆ‘å¯ä»¥æä¾›æ›´ç²¾ç¡®çš„è§£å†³æ–¹æ¡ˆã€‚</span></p></div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">=== æ‰€æœ‰é¡¶çº§çª—å£ ===
çª—å£: ä»»åŠ¡æ  (ç±»å: Shell_TrayWnd)
çª—å£: Administrator: PowerShell (ç±»å: CASCADIA_HOSTING_WINDOW_CLASS)
çª—å£: q.py - HaloPixelToolBox - Cursor (ç±»å: Chrome_WidgetWin_1)
çª—å£: è·å–QQéŸ³ä¹è¿›åº¦æ¡æç¤ºæ–‡æœ¬æ–¹æ³• - DeepSeek å’Œå¦å¤– 41 ä¸ªé¡µé¢ - ç”¨æˆ·é…ç½® 1 - Microsoftâ€‹ Edge (ç±»å: Chrome_WidgetWin_1)
çª—å£: LiLyric - æ–‡ä»¶èµ„æºç®¡ç†å™¨ (ç±»å: CabinetWClass)
çª—å£: è¿Ÿæ¥çš„æƒ…è¯ - å¼ å®¶æ—º    (ç±»å: TXGuiFoundation)
çª—å£: Cheat Engine (ç±»å: Window)
çª—å£: ä»»åŠ¡ç®¡ç†å™¨ (ç±»å: TaskManagerWindow)
çª—å£: settings.json - Notepad (ç±»å: Notepad)
çª—å£: QQ (ç±»å: Chrome_WidgetWin_1)
çª—å£: Steam (ç±»å: SDL_app)
çª—å£: Clash Verge (ç±»å: Tauri Window)
çª—å£: dummyLayeredWnd (ç±»å: DuiHostWnd)
çª—å£: dummyLayeredWnd (ç±»å: DuiHostWnd)
çª—å£: NxDock (ç±»å: ThunderRT5Form)
çª—å£: Program Manager (ç±»å: Progman)

=== æŸ¥æ‰¾QQéŸ³ä¹ç›¸å…³çª—å£ ===
Traceback (most recent call last):
  File "D:\software\HaloPixelToolBox\q.py", line 15, in &lt;module&gt;
    if "QQéŸ³ä¹" in window.Name:</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>å¾ˆå¥½ï¼ä»è°ƒè¯•è¾“å‡ºå¯ä»¥çœ‹åˆ°å‡ ä¸ªé‡è¦ä¿¡æ¯ï¼š</span></p><h2><span>å…³é”®å‘ç°ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><span>QQéŸ³ä¹çª—å£çš„</span><strong><span>ç±»å</span></strong><span>æ˜¯ </span><code>TXGuiFoundation</code></p></li><li><p class="ds-markdown-paragraph"><span>çª—å£çš„</span><strong><span>åç§°</span></strong><span>æ˜¯åŠ¨æ€çš„ï¼ŒåŒ…å«å½“å‰æ’­æ”¾çš„æ­Œæ›²ä¿¡æ¯ï¼š</span><code>è¿Ÿæ¥çš„æƒ…è¯ - å¼ å®¶æ—º    </code></p></li><li><p class="ds-markdown-paragraph"><span>çª—å£åç§°æœ€åæœ‰å¤šä¸ªç©ºæ ¼ï¼ˆæ³¨æ„æœ«å°¾çš„ç©ºæ ¼ï¼‰</span></p></li></ol><h2><span>ä¿®æ­£åçš„ä»£ç ï¼š</span></h2><h3><span>1. </span><strong><span>ç›´æ¥ä½¿ç”¨ç±»åæŸ¥æ‰¾çª—å£</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># æ–¹æ³•1ï¼šç›´æ¥ä½¿ç”¨ç±»åæŸ¥æ‰¾ï¼ˆæ¨èï¼‰</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time
<span class="token keyword">import</span> pyautogui

<span class="token keyword">def</span> <span class="token function">get_qq_music_tooltip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""è·å–QQéŸ³ä¹è¿›åº¦æ¡æ‚¬åœæç¤º"""</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># ä½¿ç”¨ç±»åæŸ¥æ‰¾çª—å£ï¼Œä¸æŒ‡å®šå…·ä½“åç§°</span>
        <span class="token comment"># QQéŸ³ä¹çš„çª—å£ç±»åé€šå¸¸æ˜¯ TXGuiFoundation</span>
        window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># å¦‚æœæ‰¾ä¸åˆ°ï¼Œå°è¯•æŸ¥æ‰¾åŒ…å«"éŸ³ä¹"çš„çª—å£</span>
            <span class="token keyword">for</span> w <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> w<span class="token punctuation">.</span>Name <span class="token keyword">and</span> <span class="token string">"éŸ³ä¹"</span> <span class="token keyword">in</span> w<span class="token punctuation">.</span>Name<span class="token punctuation">:</span>
                    window <span class="token operator">=</span> w
                    <span class="token keyword">break</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¯·å…ˆå¯åŠ¨QQéŸ³ä¹å¹¶æ’­æ”¾æ­Œæ›²"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°QQéŸ³ä¹çª—å£: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ¿€æ´»çª—å£</span>
        window<span class="token punctuation">.</span>SetActive<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        
        <span class="token comment"># è·å–çª—å£ä½ç½®å’Œå¤§å°</span>
        rect <span class="token operator">=</span> window<span class="token punctuation">.</span>BoundingRectangle
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"çª—å£ä½ç½®: </span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># QQéŸ³ä¹è¿›åº¦æ¡é€šå¸¸ä½äºçª—å£åº•éƒ¨</span>
        <span class="token comment"># è®¡ç®—å¯èƒ½çš„è¿›åº¦æ¡åŒºåŸŸ</span>
        progress_bar_y <span class="token operator">=</span> rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> <span class="token number">50</span>  <span class="token comment"># è·ç¦»åº•éƒ¨50åƒç´ </span>
        progress_bar_height <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment"># è¿›åº¦æ¡é«˜åº¦çº¦10åƒç´ </span>
        
        <span class="token comment"># åœ¨è¿›åº¦æ¡åŒºåŸŸæ°´å¹³ç§»åŠ¨é¼ æ ‡ï¼Œå¯»æ‰¾å·¥å…·æç¤º</span>
        <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span>left <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">,</span> rect<span class="token punctuation">.</span>right <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># åœ¨è¿›åº¦æ¡é«˜åº¦çš„èŒƒå›´å†…å‚ç›´æ‰«æ</span>
            <span class="token keyword">for</span> y_offset <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># ä¸Šä¸‹æ‰«æ</span>
                y <span class="token operator">=</span> progress_bar_y <span class="token operator">+</span> y_offset
                pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> duration<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">)</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
                
                <span class="token comment"># æ£€æŸ¥æ˜¯å¦æœ‰å·¥å…·æç¤ºå‡ºç°</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    <span class="token comment"># æŸ¥æ‰¾æ‰€æœ‰å·¥å…·æç¤ºæ§ä»¶</span>
                    <span class="token keyword">for</span> control <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">:</span>
                            text <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
                            <span class="token keyword">if</span> text <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°å·¥å…·æç¤º: </span><span class="token interpolation"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                                <span class="token keyword">return</span> text
                <span class="token keyword">except</span><span class="token punctuation">:</span>
                    <span class="token keyword">pass</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªæ‰¾åˆ°å·¥å…·æç¤º"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
        
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"é”™è¯¯: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"5ç§’å†…è¯·åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£..."</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> get_qq_music_tooltip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ç»“æœ: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>2. </span><strong><span>æ›´ç²¾ç¡®çš„æ–¹æ³•ï¼šé€šè¿‡æ§ä»¶IDæŸ¥æ‰¾</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># æ–¹æ³•2ï¼šä½¿ç”¨Inspectå·¥å…·è·å–çš„æ§ä»¶ID</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">get_tooltip_by_control_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""é€šè¿‡æ§ä»¶è‡ªåŠ¨åŒ–IDæŸ¥æ‰¾"""</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># æŸ¥æ‰¾QQéŸ³ä¹çª—å£</span>
        window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"çª—å£æ ‡é¢˜: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ–¹æ³•Aï¼šæŸ¥æ‰¾æ‰€æœ‰æ»‘å—æ§ä»¶</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æŸ¥æ‰¾æ»‘å—æ§ä»¶..."</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>SliderControl<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°æ»‘å—: </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                rect <span class="token operator">=</span> control<span class="token punctuation">.</span>BoundingRectangle
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ä½ç½®: </span><span class="token interpolation"><span class="token punctuation">{</span>rect<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                
                <span class="token comment"># ç§»åŠ¨åˆ°æ»‘å—ä¸­å¿ƒ</span>
                center_x <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>left <span class="token operator">+</span> rect<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
                center_y <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>top <span class="token operator">+</span> rect<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
                auto<span class="token punctuation">.</span>SetCursorPos<span class="token punctuation">(</span>center_x<span class="token punctuation">,</span> center_y<span class="token punctuation">)</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                
                <span class="token comment"># æŸ¥æ‰¾å·¥å…·æç¤º</span>
                tooltip <span class="token operator">=</span> auto<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> tooltip<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> tooltip<span class="token punctuation">.</span>Name
        
        <span class="token comment"># æ–¹æ³•Bï¼šæŸ¥æ‰¾æ‰€æœ‰æŒ‰é’®ï¼ˆQQéŸ³ä¹çš„è¿›åº¦æ¡å¯èƒ½è¢«å®ç°ä¸ºæŒ‰é’®ï¼‰</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\næŸ¥æ‰¾æŒ‰é’®æ§ä»¶..."</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ButtonControl<span class="token punctuation">:</span>
                name <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
                <span class="token keyword">if</span> name <span class="token keyword">and</span> <span class="token builtin">any</span><span class="token punctuation">(</span>keyword <span class="token keyword">in</span> name <span class="token keyword">for</span> keyword <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'è¿›åº¦'</span><span class="token punctuation">,</span> <span class="token string">'æ’­æ”¾'</span><span class="token punctuation">,</span> <span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°ç›¸å…³æŒ‰é’®: </span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ–¹æ³•Cï¼šä½¿ç”¨æ›´é€šç”¨çš„æ–¹æ³•ï¼Œéå†æ‰€æœ‰æ§ä»¶</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\néå†æ‰€æœ‰æ§ä»¶..."</span><span class="token punctuation">)</span>
        controls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            controls<span class="token punctuation">.</span>append<span class="token punctuation">(</span>control<span class="token punctuation">)</span>
            
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ€»å…±æ‰¾åˆ° </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>controls<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> ä¸ªæ§ä»¶"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ‰“å°å‰20ä¸ªæ§ä»¶çš„ä¿¡æ¯</span>
        <span class="token keyword">for</span> i<span class="token punctuation">,</span> control <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>controls<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>ControlTypeName<span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> <span class="token boolean">None</span>
        
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"é”™è¯¯: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> get_tooltip_by_control_id<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ç»“æœ: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>3. </span><strong><span>ä½¿ç”¨Windows APIç›´æ¥è·å–å·¥å…·æç¤º</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># æ–¹æ³•3ï¼šä½¿ç”¨Windows API</span>
<span class="token keyword">import</span> ctypes
<span class="token keyword">import</span> ctypes<span class="token punctuation">.</span>wintypes
<span class="token keyword">import</span> time

user32 <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>windll<span class="token punctuation">.</span>user32

<span class="token keyword">class</span> <span class="token class-name">POINT</span><span class="token punctuation">(</span>ctypes<span class="token punctuation">.</span>Structure<span class="token punctuation">)</span><span class="token punctuation">:</span>
    _fields_ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">,</span> ctypes<span class="token punctuation">.</span>c_long<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"y"</span><span class="token punctuation">,</span> ctypes<span class="token punctuation">.</span>c_long<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">get_tooltip_text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ä½¿ç”¨Windows APIè·å–å·¥å…·æç¤ºæ–‡æœ¬"""</span>
    <span class="token comment"># è·å–å½“å‰é¼ æ ‡ä½ç½®</span>
    pt <span class="token operator">=</span> POINT<span class="token punctuation">(</span><span class="token punctuation">)</span>
    user32<span class="token punctuation">.</span>GetCursorPos<span class="token punctuation">(</span>ctypes<span class="token punctuation">.</span>byref<span class="token punctuation">(</span>pt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># è·å–é¼ æ ‡ä½ç½®ä¸‹çš„çª—å£å¥æŸ„</span>
    hwnd <span class="token operator">=</span> user32<span class="token punctuation">.</span>WindowFromPoint<span class="token punctuation">(</span>pt<span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> hwnd<span class="token punctuation">:</span>
        <span class="token comment"># è·å–çª—å£ç±»å</span>
        class_name <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>create_unicode_buffer<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
        user32<span class="token punctuation">.</span>GetClassNameW<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> class_name<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>
        
        <span class="token comment"># è·å–çª—å£æ–‡æœ¬</span>
        text <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>create_unicode_buffer<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
        user32<span class="token punctuation">.</span>GetWindowTextW<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ£€æŸ¥æ˜¯å¦æ˜¯å·¥å…·æç¤ºçª—å£ï¼ˆç±»åé€šå¸¸ä¸º"tooltips_class32"ï¼‰</span>
        <span class="token keyword">if</span> <span class="token string">"tooltip"</span> <span class="token keyword">in</span> class_name<span class="token punctuation">.</span>value<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>value<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> text<span class="token punctuation">.</span>value
    
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">monitor_qq_music_tooltip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ç›‘æ§QQéŸ³ä¹å·¥å…·æç¤º"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç›‘æ§QQéŸ³ä¹å·¥å…·æç¤ºï¼ŒæŒ‰Ctrl+Cåœæ­¢..."</span><span class="token punctuation">)</span>
    last_text <span class="token operator">=</span> <span class="token string">""</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token comment"># è·å–å½“å‰æ´»åŠ¨çª—å£</span>
            hwnd <span class="token operator">=</span> user32<span class="token punctuation">.</span>GetForegroundWindow<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> hwnd<span class="token punctuation">:</span>
                text <span class="token operator">=</span> ctypes<span class="token punctuation">.</span>create_unicode_buffer<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
                user32<span class="token punctuation">.</span>GetWindowTextW<span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>
                window_title <span class="token operator">=</span> text<span class="token punctuation">.</span>value
                
                <span class="token comment"># å¦‚æœæ˜¯QQéŸ³ä¹çª—å£</span>
                <span class="token keyword">if</span> <span class="token string">"éŸ³ä¹"</span> <span class="token keyword">in</span> window_title <span class="token keyword">or</span> <span class="token string">"QQ"</span> <span class="token keyword">in</span> window_title<span class="token punctuation">:</span>
                    tooltip_text <span class="token operator">=</span> get_tooltip_text<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> tooltip_text <span class="token keyword">and</span> tooltip_text <span class="token operator">!=</span> last_text<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"å·¥å…·æç¤º: </span><span class="token interpolation"><span class="token punctuation">{</span>tooltip_text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                        last_text <span class="token operator">=</span> tooltip_text
            
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç›‘æ§å·²åœæ­¢"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    monitor_qq_music_tooltip<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>4. </span><strong><span>ç®€åŒ–ç‰ˆï¼šä½¿ç”¨é”®ç›˜å¿«æ·é”®è§¦å‘</span></strong></h3><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># æ–¹æ³•4ï¼šç»“åˆé”®ç›˜å¿«æ·é”®</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> pyautogui
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">get_tooltip_simple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ç®€åŒ–ç‰ˆï¼šå…ˆèšç„¦åˆ°QQéŸ³ä¹ï¼Œç„¶åé¼ æ ‡ç§»åŠ¨åˆ°å¸¸è§ä½ç½®"""</span>
    
    <span class="token comment"># åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£</span>
    window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        window<span class="token punctuation">.</span>SetActive<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        
        <span class="token comment"># ä½¿ç”¨é”®ç›˜å¿«æ·é”® Ctrl+1 ç¡®ä¿ç„¦ç‚¹åœ¨æ’­æ”¾åŒºåŸŸ</span>
        pyautogui<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">'ctrl'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        
        <span class="token comment"># è·å–çª—å£ä¸­å¿ƒä½ç½®ï¼ˆè¿›åº¦æ¡é€šå¸¸åœ¨ä¸­ä¸‹éƒ¨ï¼‰</span>
        rect <span class="token operator">=</span> window<span class="token punctuation">.</span>BoundingRectangle
        center_x <span class="token operator">=</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>left <span class="token operator">+</span> rect<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
        bottom_y <span class="token operator">=</span> rect<span class="token punctuation">.</span>bottom <span class="token operator">-</span> <span class="token number">30</span>
        
        <span class="token comment"># é¼ æ ‡ç§»åŠ¨åˆ°è¿›åº¦æ¡ä½ç½®</span>
        pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>center_x<span class="token punctuation">,</span> bottom_y<span class="token punctuation">,</span> duration<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ°´å¹³ç§»åŠ¨é¼ æ ‡ä»¥è§¦å‘å·¥å…·æç¤º</span>
        <span class="token keyword">for</span> offset <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>center_x <span class="token operator">+</span> offset<span class="token punctuation">,</span> bottom_y<span class="token punctuation">,</span> duration<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>
            
            <span class="token comment"># å°è¯•è·å–å·¥å…·æç¤º</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> control <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">:</span>
                        text <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
                        <span class="token keyword">if</span> text <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                            <span class="token keyword">return</span> text
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
    
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> get_tooltip_simple<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"å·¥å…·æç¤ºæ–‡æœ¬: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h3><span>5. </span><strong><span>ä½¿ç”¨å¤–éƒ¨å·¥å…·è¾…åŠ©åˆ†æ</span></strong></h3><p class="ds-markdown-paragraph"><span>å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½ä¸è¡Œï¼Œå»ºè®®ï¼š</span></p><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>ä¸‹è½½ Accessible Event Watcher (AccEvent)</span></strong></p><ul><li><p class="ds-markdown-paragraph"><span>å¯ä»¥å®æ—¶ç›‘æ§UIè‡ªåŠ¨åŒ–äº‹ä»¶</span></p></li><li><p class="ds-markdown-paragraph"><span>æŸ¥çœ‹å·¥å…·æç¤ºä½•æ—¶å‡ºç°</span></p></li></ul></li><li><p class="ds-markdown-paragraph"><strong><span>ä½¿ç”¨æ›´ç®€å•çš„æ–¹æ³•ï¼šå±å¹•å–è‰²åˆ¤æ–­</span></strong></p></li></ol><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># æ–¹æ³•5ï¼šé€šè¿‡å±å¹•é¢œè‰²åˆ¤æ–­ä½ç½®</span>
<span class="token keyword">import</span> pyautogui
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">find_progress_bar_by_color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""é€šè¿‡é¢œè‰²ç‰¹å¾æ‰¾åˆ°è¿›åº¦æ¡ä½ç½®"""</span>
    
    <span class="token comment"># åˆ‡æ¢åˆ°QQéŸ³ä¹</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    
    <span class="token comment"># æˆªå–å±å¹•</span>
    screenshot <span class="token operator">=</span> pyautogui<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token punctuation">)</span>
    width<span class="token punctuation">,</span> height <span class="token operator">=</span> screenshot<span class="token punctuation">.</span>size
    
    <span class="token comment"># åœ¨å±å¹•åº•éƒ¨åŒºåŸŸæŸ¥æ‰¾QQéŸ³ä¹çš„è¿›åº¦æ¡</span>
    <span class="token comment"># QQéŸ³ä¹è¿›åº¦æ¡é€šå¸¸æ˜¯æµ…è“è‰²æˆ–ç»¿è‰²</span>
    progress_colors <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">(</span><span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token comment"># æµ…è“è‰²</span>
        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">197</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">)</span><span class="token punctuation">,</span>     <span class="token comment"># ç»¿è‰²</span>
        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">178</span><span class="token punctuation">,</span> <span class="token number">148</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment"># é’è‰²</span>
    <span class="token punctuation">]</span>
    
    <span class="token comment"># æ‰«æå±å¹•åº•éƒ¨</span>
    <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>height <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">,</span> height <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> width <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            pixel <span class="token operator">=</span> screenshot<span class="token punctuation">.</span>getpixel<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token comment"># æ£€æŸ¥æ˜¯å¦æ¥è¿‘è¿›åº¦æ¡é¢œè‰²</span>
            <span class="token keyword">for</span> target_color <span class="token keyword">in</span> progress_colors<span class="token punctuation">:</span>
                diff <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>pixel<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> target_color<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> diff <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">:</span>  <span class="token comment"># é¢œè‰²ç›¸è¿‘</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°å¯èƒ½çš„è¿›åº¦æ¡ä½ç½®: (</span><span class="token interpolation"><span class="token punctuation">{</span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>y<span class="token punctuation">}</span></span><span class="token string">), é¢œè‰²: </span><span class="token interpolation"><span class="token punctuation">{</span>pixel<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    
                    <span class="token comment"># ç§»åŠ¨é¼ æ ‡åˆ°è¯¥ä½ç½®</span>
                    pyautogui<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
                    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                    
                    <span class="token comment"># è¿™é‡Œå¯ä»¥ç»“åˆä¹‹å‰çš„å·¥å…·æç¤ºè·å–æ–¹æ³•</span>
                    <span class="token keyword">return</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token boolean">None</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>å»ºè®®çš„æµ‹è¯•æ­¥éª¤ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>å…ˆè¿è¡Œç¬¬ä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬</span></strong></p><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">bash</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre>python method1.py</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div></li><li><p class="ds-markdown-paragraph"><strong><span>å¦‚æœä¸è¡Œï¼Œä½¿ç”¨ Windows è‡ªå¸¦çš„è®²è¿°äººåŠŸèƒ½æµ‹è¯•</span></strong></p><ul><li><p class="ds-markdown-paragraph"><span>æŒ‰ Win+Ctrl+Enter æ‰“å¼€è®²è¿°äºº</span></p></li><li><p class="ds-markdown-paragraph"><span>å°†é¼ æ ‡ç§»åŠ¨åˆ°QQéŸ³ä¹è¿›åº¦æ¡ä¸Š</span></p></li><li><p class="ds-markdown-paragraph"><span>æŸ¥çœ‹è®²è¿°äººæ˜¯å¦è¯»å‡ºæ—¶é—´ä¿¡æ¯</span></p></li></ul></li><li><p class="ds-markdown-paragraph"><strong><span>æœ€å¯é çš„å¤‡é€‰æ–¹æ¡ˆï¼šOCR</span></strong><span></span><br><span>å¦‚æœè‡ªåŠ¨åŒ–æ–¹æ³•éƒ½ä¸è¡Œï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æˆªå›¾+OCRæ–¹æ¡ˆï¼Œè™½ç„¶æ…¢ä½†æœ€å¯é ã€‚</span></p></li></ol><p class="ds-markdown-paragraph"><span>è¯·å…ˆè¿è¡Œç¬¬ä¸€ä¸ªæ–¹æ³•ï¼Œå‘Šè¯‰æˆ‘ç»“æœå¦‚ä½•ï¼Œæˆ‘å¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µè¿›ä¸€æ­¥è°ƒæ•´ã€‚</span></p></div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">å¯¹äºç¬¬1ä¸ªæ–¹æ³•ï¼Œä¸ç”¨ä½ æ¥ç§»åŠ¨é¼ æ ‡ï¼Œæˆ‘ä¼šæ¥ç§»åŠ¨</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>æ˜ç™½äº†ï¼æˆ‘æ¥ä¿®æ”¹ä»£ç ï¼Œè®©ä½ æ‰‹åŠ¨æ§åˆ¶é¼ æ ‡ç§»åŠ¨ï¼Œç¨‹åºåªè´Ÿè´£æ£€æµ‹å’Œæ˜¾ç¤ºå·¥å…·æç¤ºï¼š</span></p><h2><span>æ–¹æ¡ˆä¸€ï¼šå®æ—¶ç›‘æ§å·¥å…·æç¤ºï¼ˆæ¨èï¼‰</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># tooltip_monitor.py - å®æ—¶ç›‘æ§å·¥å…·æç¤º</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">monitor_tooltip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""å®æ—¶ç›‘æ§å·¥å…·æç¤ºå˜åŒ–"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== QQéŸ³ä¹å·¥å…·æç¤ºç›‘æ§å™¨ ==="</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ä½¿ç”¨æ–¹æ³•ï¼š"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1. ç¡®ä¿QQéŸ³ä¹æ­£åœ¨è¿è¡Œå¹¶æ’­æ”¾æ­Œæ›²"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"2. å°†é¼ æ ‡ç§»åŠ¨åˆ°QQéŸ³ä¹çš„è¿›åº¦æ¡ä¸Š"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"3. ç¨‹åºä¼šå®æ—¶æ˜¾ç¤ºå‡ºç°çš„å·¥å…·æç¤ºæ–‡æœ¬"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"4. æŒ‰ Ctrl+C åœæ­¢ç›‘æ§\n"</span><span class="token punctuation">)</span>
    
    last_text <span class="token operator">=</span> <span class="token string">""</span>
    check_count <span class="token operator">=</span> <span class="token number">0</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token comment"># æŸ¥æ‰¾æ‰€æœ‰å·¥å…·æç¤ºæ§ä»¶</span>
            tooltips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> control <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">:</span>
                    text <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
                    <span class="token keyword">if</span> text <span class="token keyword">and</span> text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        tooltips<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>control<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token comment"># å¦‚æœæœ‰å·¥å…·æç¤ºï¼Œæ˜¾ç¤ºæœ€æ–°çš„</span>
            <span class="token keyword">if</span> tooltips<span class="token punctuation">:</span>
                <span class="token comment"># è·å–æœ€ä¸Šé¢çš„å·¥å…·æç¤ºï¼ˆé€šå¸¸æœ€åä¸€ä¸ªæ˜¯æœ€æ–°çš„ï¼‰</span>
                _<span class="token punctuation">,</span> current_text <span class="token operator">=</span> tooltips<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                
                <span class="token keyword">if</span> current_text <span class="token operator">!=</span> last_text<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ğŸ“Š è¿›åº¦æç¤º: </span><span class="token interpolation"><span class="token punctuation">{</span>current_text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                    last_text <span class="token operator">=</span> current_text
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> last_text<span class="token punctuation">:</span>
                    <span class="token comment"># å·¥å…·æç¤ºæ¶ˆå¤±äº†</span>
                    last_text <span class="token operator">=</span> <span class="token string">""</span>
            
            <span class="token comment"># æ¯50æ¯«ç§’æ£€æŸ¥ä¸€æ¬¡</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>
            check_count <span class="token operator">+=</span> <span class="token number">1</span>
            
            <span class="token comment"># æ¯2ç§’æ˜¾ç¤ºä¸€æ¬¡çŠ¶æ€</span>
            <span class="token keyword">if</span> check_count <span class="token operator">%</span> <span class="token number">40</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"â³ ç›‘æ§ä¸­... ç§»åŠ¨é¼ æ ‡åˆ°QQéŸ³ä¹è¿›åº¦æ¡ä¸ŠæŸ¥çœ‹æç¤º"</span><span class="token punctuation">)</span>
                
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nâœ… ç›‘æ§å·²åœæ­¢"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    monitor_tooltip<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>æ–¹æ¡ˆäºŒï¼šç®€æ´ç‰ˆï¼Œä»…åœ¨æœ‰å˜åŒ–æ—¶æ˜¾ç¤º</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># simple_tooltip_detector.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">detect_tooltip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""æ£€æµ‹å·¥å…·æç¤ºï¼Œåªåœ¨å˜åŒ–æ—¶æ˜¾ç¤º"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"QQéŸ³ä¹è¿›åº¦æç¤ºæ£€æµ‹å™¨"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç§»åŠ¨é¼ æ ‡åˆ°è¿›åº¦æ¡ä¸Šå³å¯çœ‹åˆ°æ—¶é—´æç¤º"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æŒ‰ Ctrl+C é€€å‡º\n"</span><span class="token punctuation">)</span>
    
    last_text <span class="token operator">=</span> <span class="token string">""</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            found <span class="token operator">=</span> <span class="token boolean">False</span>
            
            <span class="token comment"># éå†æ‰€æœ‰çª—å£æŸ¥æ‰¾å·¥å…·æç¤º</span>
            <span class="token keyword">for</span> window <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># æ£€æŸ¥è¿™ä¸ªçª—å£åŠå…¶å­çª—å£ä¸­çš„å·¥å…·æç¤º</span>
                <span class="token keyword">for</span> control <span class="token keyword">in</span> auto<span class="token punctuation">.</span>WalkControl<span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">:</span>
                        text <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
                        <span class="token keyword">if</span> text <span class="token keyword">and</span> text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> text <span class="token operator">!=</span> last_text<span class="token punctuation">:</span>
                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ğŸ•’ </span><span class="token interpolation"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                            last_text <span class="token operator">=</span> text
                            found <span class="token operator">=</span> <span class="token boolean">True</span>
                            <span class="token keyword">break</span>
                <span class="token keyword">if</span> found<span class="token punctuation">:</span>
                    <span class="token keyword">break</span>
            
            <span class="token comment"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°å·¥å…·æç¤ºï¼Œé‡ç½®last_text</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> found <span class="token keyword">and</span> last_text<span class="token punctuation">:</span>
                last_text <span class="token operator">=</span> <span class="token string">""</span>
            
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>  <span class="token comment"># é™ä½CPUå ç”¨</span>
            
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\né€€å‡ºæ£€æµ‹"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    detect_tooltip<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>æ–¹æ¡ˆä¸‰ï¼šå¢å¼ºç‰ˆï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># enhanced_tooltip_detector.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token keyword">class</span> <span class="token class-name">QQMusicTooltipDetector</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>last_text <span class="token operator">=</span> <span class="token string">""</span>
        self<span class="token punctuation">.</span>start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>detected_count <span class="token operator">=</span> <span class="token number">0</span>
        
    <span class="token keyword">def</span> <span class="token function">get_current_time</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""è·å–å½“å‰æ—¶é—´å­—ç¬¦ä¸²"""</span>
        <span class="token keyword">return</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%H:%M:%S"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">is_qq_music_active</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""æ£€æŸ¥QQéŸ³ä¹æ˜¯å¦æ´»è·ƒ"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            foreground <span class="token operator">=</span> auto<span class="token punctuation">.</span>GetForegroundControl<span class="token punctuation">(</span><span class="token punctuation">)</span>
            window_title <span class="token operator">=</span> foreground<span class="token punctuation">.</span>Name
            
            <span class="token comment"># QQéŸ³ä¹çª—å£æ ‡é¢˜é€šå¸¸åŒ…å«æ­Œæ›²ä¿¡æ¯</span>
            <span class="token keyword">if</span> window_title <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token string">" - "</span> <span class="token keyword">in</span> window_title <span class="token keyword">or</span> <span class="token string">"éŸ³ä¹"</span> <span class="token keyword">in</span> window_title<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">True</span>
                
            <span class="token comment"># æˆ–è€…æ£€æŸ¥çª—å£ç±»å</span>
            <span class="token keyword">for</span> window <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> window<span class="token punctuation">.</span>ClassName <span class="token operator">==</span> <span class="token string">'TXGuiFoundation'</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token boolean">True</span>
                    
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    
    <span class="token keyword">def</span> <span class="token function">detect</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""ä¸»æ£€æµ‹å¾ªç¯"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ğŸµ QQéŸ³ä¹è¿›åº¦æç¤ºæ£€æµ‹å™¨ ğŸµ"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span> <span class="token operator">*</span> <span class="token number">40</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¯´æ˜ï¼š"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1. ç¡®ä¿QQéŸ³ä¹æ­£åœ¨æ’­æ”¾æ­Œæ›²"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"2. å°†é¼ æ ‡æ‚¬åœåœ¨è¿›åº¦æ¡ä¸Š"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"3. ç¨‹åºä¼šè‡ªåŠ¨æ˜¾ç¤ºæ—¶é—´æç¤º"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"4. æŒ‰ Ctrl+C é€€å‡ºç¨‹åº"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span> <span class="token operator">*</span> <span class="token number">40</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>
        
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                <span class="token comment"># æ£€æŸ¥QQéŸ³ä¹æ˜¯å¦æ´»è·ƒ</span>
                <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>is_qq_music_active<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token keyword">continue</span>
                
                <span class="token comment"># æŸ¥æ‰¾å·¥å…·æç¤º</span>
                tooltip_found <span class="token operator">=</span> <span class="token boolean">False</span>
                <span class="token keyword">for</span> control <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">:</span>
                        text <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
                        <span class="token keyword">if</span> text <span class="token keyword">and</span> text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                            <span class="token comment"># è¿‡æ»¤æ‰éæ—¶é—´æ ¼å¼çš„æç¤ºï¼ˆQQéŸ³ä¹çš„è¿›åº¦æç¤ºé€šå¸¸åŒ…å«æ–œæ æˆ–å†’å·ï¼‰</span>
                            <span class="token keyword">if</span> <span class="token string">'/'</span> <span class="token keyword">in</span> text <span class="token keyword">or</span> <span class="token string">':'</span> <span class="token keyword">in</span> text<span class="token punctuation">:</span>
                                <span class="token keyword">if</span> text <span class="token operator">!=</span> self<span class="token punctuation">.</span>last_text<span class="token punctuation">:</span>
                                    self<span class="token punctuation">.</span>detected_count <span class="token operator">+=</span> <span class="token number">1</span>
                                    current_time <span class="token operator">=</span> self<span class="token punctuation">.</span>get_current_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[</span><span class="token interpolation"><span class="token punctuation">{</span>current_time<span class="token punctuation">}</span></span><span class="token string">] æ£€æµ‹ #</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>detected_count<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                                    self<span class="token punctuation">.</span>last_text <span class="token operator">=</span> text
                                tooltip_found <span class="token operator">=</span> <span class="token boolean">True</span>
                                <span class="token keyword">break</span>
                
                <span class="token keyword">if</span> <span class="token keyword">not</span> tooltip_found <span class="token keyword">and</span> self<span class="token punctuation">.</span>last_text<span class="token punctuation">:</span>
                    <span class="token comment"># å·¥å…·æç¤ºæ¶ˆå¤±äº†</span>
                    self<span class="token punctuation">.</span>last_text <span class="token operator">=</span> <span class="token string">""</span>
                
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span>  <span class="token comment"># å¿«é€Ÿå“åº”</span>
                
        <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
            elapsed <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>start_time
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nğŸ“Š ç»Ÿè®¡ä¿¡æ¯:"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è¿è¡Œæ—¶é—´: </span><span class="token interpolation"><span class="token punctuation">{</span>elapsed<span class="token punctuation">:</span><span class="token format-spec">.1f</span><span class="token punctuation">}</span></span><span class="token string">ç§’"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ£€æµ‹åˆ°æç¤ºæ¬¡æ•°: </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>detected_count<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ğŸ‘‹ ç¨‹åºå·²é€€å‡º"</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    detector <span class="token operator">=</span> QQMusicTooltipDetector<span class="token punctuation">(</span><span class="token punctuation">)</span>
    detector<span class="token punctuation">.</span>detect<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>æ–¹æ¡ˆå››ï¼šæœ€å°åŒ–ç‰ˆæœ¬ï¼ˆæœ€ç®€æ´ï¼‰</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># min_tooltip.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

last <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> c<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">:</span>
            t <span class="token operator">=</span> c<span class="token punctuation">.</span>Name
            <span class="token keyword">if</span> t <span class="token keyword">and</span> t <span class="token operator">!=</span> last<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
                last <span class="token operator">=</span> t
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.05</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>ä½¿ç”¨è¯´æ˜ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>é€‰æ‹©ä»»æ„ä¸€ä¸ªç‰ˆæœ¬</span></strong><span>ï¼Œä¿å­˜ä¸º </span><code>.py</code><span> æ–‡ä»¶</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>è¿è¡Œç¨‹åº</span></strong><span>ï¼š</span></p><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">bash</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre>python tooltip_monitor.py</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div></li><li><p class="ds-markdown-paragraph"><strong><span>åˆ‡æ¢åˆ°QQéŸ³ä¹çª—å£</span></strong><span>ï¼Œå°†é¼ æ ‡ç§»åŠ¨åˆ°è¿›åº¦æ¡ä¸Š</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>ç¨‹åºä¼šè‡ªåŠ¨æ˜¾ç¤º</span></strong><span>å‡ºç°çš„å·¥å…·æç¤ºæ–‡æœ¬</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>æŒ‰ Ctrl+C</span></strong><span> åœæ­¢ç¨‹åº</span></p></li></ol><h2><span>å¦‚æœä¸Šè¿°æ–¹æ³•æ— æ•ˆçš„å¤‡é€‰æ–¹æ¡ˆï¼š</span></h2><p class="ds-markdown-paragraph"><span>å¦‚æœQQéŸ³ä¹ä½¿ç”¨è‡ªå®šä¹‰ç»˜åˆ¶è€Œä¸æ˜¯æ ‡å‡†å·¥å…·æç¤ºæ§ä»¶ï¼Œå¯ä»¥å°è¯•è¿™ä¸ªç‰ˆæœ¬ï¼š</span></p><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># universal_tooltip_detector.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">find_all_tooltips</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""æŸ¥æ‰¾æ‰€æœ‰å¯èƒ½çš„å·¥å…·æç¤ºæ§ä»¶"""</span>
    tooltip_classes <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'ToolTip'</span><span class="token punctuation">,</span>  <span class="token comment"># æ ‡å‡†å·¥å…·æç¤º</span>
        <span class="token string">'tooltips_class32'</span><span class="token punctuation">,</span>  <span class="token comment"># Windowså·¥å…·æç¤ºç±»</span>
        <span class="token string">'TXGuiFoundation'</span><span class="token punctuation">,</span>  <span class="token comment"># QQéŸ³ä¹å¯èƒ½ä½¿ç”¨çš„</span>
        <span class="token string">'Qt5QWindowToolSaveBits'</span><span class="token punctuation">,</span>  <span class="token comment"># Qtåº”ç”¨</span>
        <span class="token string">'Qt5QWindowIcon'</span><span class="token punctuation">,</span>  <span class="token comment"># Qtåº”ç”¨</span>
    <span class="token punctuation">]</span>
    
    found <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># æ–¹æ³•1ï¼šæŒ‰æ§ä»¶ç±»å‹æŸ¥æ‰¾</span>
    <span class="token keyword">for</span> control <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ToolTipControl<span class="token punctuation">:</span>
            found<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"ToolTipControl"</span><span class="token punctuation">,</span> control<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># æ–¹æ³•2ï¼šæŒ‰ç±»åæŸ¥æ‰¾</span>
    <span class="token keyword">for</span> window <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        class_name <span class="token operator">=</span> window<span class="token punctuation">.</span>ClassName
        <span class="token keyword">for</span> target_class <span class="token keyword">in</span> tooltip_classes<span class="token punctuation">:</span>
            <span class="token keyword">if</span> target_class <span class="token keyword">in</span> class_name<span class="token punctuation">:</span>
                text <span class="token operator">=</span> window<span class="token punctuation">.</span>Name
                <span class="token keyword">if</span> text <span class="token keyword">and</span> text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    found<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Class: </span><span class="token interpolation"><span class="token punctuation">{</span>class_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> found

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"é€šç”¨å·¥å…·æç¤ºæ£€æµ‹å™¨"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å°è¯•æ£€æµ‹å„ç§ç±»å‹çš„å·¥å…·æç¤º...\n"</span><span class="token punctuation">)</span>
    
    last_texts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            tooltips <span class="token operator">=</span> find_all_tooltips<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> tooltips <span class="token keyword">and</span> tooltips <span class="token operator">!=</span> last_texts<span class="token punctuation">:</span>
                <span class="token keyword">for</span> tooltip_type<span class="token punctuation">,</span> text <span class="token keyword">in</span> tooltips<span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[</span><span class="token interpolation"><span class="token punctuation">{</span>tooltip_type<span class="token punctuation">}</span></span><span class="token string">] </span><span class="token interpolation"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                last_texts <span class="token operator">=</span> tooltips
            
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
            
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\næ£€æµ‹ç»“æŸ"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>å»ºè®®ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><span>ä»</span><strong><span>æ–¹æ¡ˆä¸€</span></strong><span>å¼€å§‹å°è¯•ï¼Œå®ƒæœ€ç®€å•ç›´æ¥</span></p></li><li><p class="ds-markdown-paragraph"><span>å¦‚æœæ–¹æ¡ˆä¸€æ— æ•ˆï¼Œå°è¯•</span><strong><span>æ–¹æ¡ˆä¸‰</span></strong><span>å¢å¼ºç‰ˆ</span></p></li><li><p class="ds-markdown-paragraph"><span>å¦‚æœéƒ½ä¸è¡Œï¼Œå¯èƒ½æ˜¯QQéŸ³ä¹ä½¿ç”¨äº†ç‰¹æ®Šçš„UIæŠ€æœ¯ï¼Œéœ€è¦æ›´å¤æ‚çš„æ£€æµ‹æ–¹æ³•</span></p></li></ol><p class="ds-markdown-paragraph"><span>è¿è¡Œåè¯·å‘Šè¯‰æˆ‘ç»“æœï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥è°ƒæ•´ä»£ç ä»¥æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚</span></p></div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">éƒ½ä¸è¡Œ</div>
        </div>
<div class="message-block role-user">
          <div class="message-role">You</div>
          <div class="message-content">æˆ‘çš„æœ€ç»ˆç›®çš„æ˜¯è·å–è¿™é¦–æ­Œçš„æ‰€æœ‰æ­Œè¯</div>
        </div>
<div class="message-block role-ai">
          <div class="message-role">AI</div>
          <div class="message-content"><p class="ds-markdown-paragraph"><span>æ˜ç™½äº†ï¼è·å–QQéŸ³ä¹çš„å…¨éƒ¨æ­Œè¯æœ‰æ›´ç›´æ¥çš„æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯å‡ ç§è·å–å…¨éƒ¨æ­Œè¯çš„æ–¹æ¡ˆï¼š</span></p><h2><span>æ–¹æ¡ˆä¸€ï¼šä»QQéŸ³ä¹ç•Œé¢ç›´æ¥è·å–æ­Œè¯</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># get_all_lyrics.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">get_all_lyrics_from_ui</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ä»QQéŸ³ä¹ç•Œé¢è·å–å…¨éƒ¨æ­Œè¯"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ­£åœ¨ä»QQéŸ³ä¹ç•Œé¢è·å–æ­Œè¯..."</span><span class="token punctuation">)</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># æŸ¥æ‰¾QQéŸ³ä¹çª—å£</span>
        window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¯·å…ˆæ‰“å¼€QQéŸ³ä¹å¹¶æ’­æ”¾æ­Œæ›²"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°QQéŸ³ä¹çª—å£: </span><span class="token interpolation"><span class="token punctuation">{</span>window<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># è·å–æ­Œæ›²ä¿¡æ¯ï¼ˆçª—å£æ ‡é¢˜é€šå¸¸æ˜¯"æ­Œæ›²å - æ­Œæ‰‹"ï¼‰</span>
        window_title <span class="token operator">=</span> window<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"å½“å‰æ’­æ”¾: </span><span class="token interpolation"><span class="token punctuation">{</span>window_title<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># å°è¯•æŸ¥æ‰¾æ­Œè¯æ§ä»¶</span>
        <span class="token comment"># QQéŸ³ä¹çš„æ­Œè¯é€šå¸¸åœ¨ä¸€ä¸ªPaneæˆ–Listæ§ä»¶ä¸­</span>
        
        <span class="token comment"># æ–¹æ³•1ï¼šæŸ¥æ‰¾æ‰€æœ‰Paneæ§ä»¶</span>
        lyrics_text <span class="token operator">=</span> <span class="token string">""</span>
        
        <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># æ‰“å°æ‰€æœ‰æ§ä»¶ç±»å‹ç”¨äºè°ƒè¯•</span>
            <span class="token keyword">if</span> control<span class="token punctuation">.</span>Name <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>control<span class="token punctuation">.</span>Name<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[</span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>ControlTypeName<span class="token punctuation">}</span></span><span class="token string">] </span><span class="token interpolation"><span class="token punctuation">{</span>control<span class="token punctuation">.</span>Name<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">50]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
            <span class="token comment"># å¦‚æœæ˜¯åˆ—è¡¨æ§ä»¶ï¼Œå¯èƒ½æ˜¯æ­Œè¯åˆ—è¡¨</span>
            <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ListControl<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ‰¾åˆ°åˆ—è¡¨æ§ä»¶ï¼Œå¯èƒ½æ˜¯æ­Œè¯åˆ—è¡¨"</span><span class="token punctuation">)</span>
                <span class="token comment"># è·å–æ‰€æœ‰åˆ—è¡¨é¡¹</span>
                items <span class="token operator">=</span> control<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> item<span class="token punctuation">.</span>Name<span class="token punctuation">:</span>
                        lyrics_text <span class="token operator">+=</span> item<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"\n"</span>
        
        <span class="token comment"># æ–¹æ³•2ï¼šæŸ¥æ‰¾åŒ…å«æ­Œè¯çš„æ–‡æœ¬æ§ä»¶</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> lyrics_text<span class="token punctuation">:</span>
            <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>TextControl<span class="token punctuation">:</span>
                    text <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
                    <span class="token keyword">if</span> text <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        <span class="token comment"># å°è¯•åˆ¤æ–­æ˜¯å¦æ˜¯æ­Œè¯ï¼ˆåŒ…å«æ—¶é—´æˆ³ï¼‰</span>
                        <span class="token keyword">if</span> <span class="token string">']'</span> <span class="token keyword">in</span> text <span class="token keyword">or</span> <span class="token string">'['</span> <span class="token keyword">in</span> text <span class="token keyword">or</span> <span class="token string">':'</span> <span class="token keyword">in</span> text<span class="token punctuation">:</span>
                            lyrics_text <span class="token operator">+=</span> text <span class="token operator">+</span> <span class="token string">"\n"</span>
        
        <span class="token comment"># æ–¹æ³•3ï¼šæŸ¥æ‰¾Editæ§ä»¶ï¼ˆå¦‚æœæ­Œè¯å¯ç¼–è¾‘ï¼‰</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> lyrics_text<span class="token punctuation">:</span>
            <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>EditControl<span class="token punctuation">:</span>
                    text <span class="token operator">=</span> control<span class="token punctuation">.</span>GetValuePattern<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value
                    <span class="token keyword">if</span> text<span class="token punctuation">:</span>
                        lyrics_text <span class="token operator">=</span> text
                        <span class="token keyword">break</span>
        
        <span class="token keyword">if</span> lyrics_text<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nè·å–åˆ°æ­Œè¯ï¼ˆé•¿åº¦: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>lyrics_text<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> å­—ç¬¦ï¼‰:"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>lyrics_text<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># åªæ˜¾ç¤ºå‰500å­—ç¬¦é¢„è§ˆ</span>
            <span class="token keyword">return</span> lyrics_text
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªæ‰¾åˆ°æ­Œè¯æ§ä»¶"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>
            
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"é”™è¯¯: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">save_lyrics_to_file</span><span class="token punctuation">(</span>lyrics<span class="token punctuation">,</span> filename<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ä¿å­˜æ­Œè¯åˆ°æ–‡ä»¶"""</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> lyrics<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ²¡æœ‰æ­Œè¯å¯ä¿å­˜"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    
    <span class="token keyword">if</span> <span class="token keyword">not</span> filename<span class="token punctuation">:</span>
        <span class="token comment"># ä½¿ç”¨çª—å£æ ‡é¢˜ä½œä¸ºæ–‡ä»¶å</span>
        window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            title <span class="token operator">=</span> window<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># æ¸…ç†æ–‡ä»¶åä¸­çš„éæ³•å­—ç¬¦</span>
            <span class="token keyword">import</span> re
            filename <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'[&lt;&gt;:"/\\|?*]'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.lrc'</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            filename <span class="token operator">=</span> <span class="token string">'lyrics.lrc'</span>
    
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>lyrics<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ­Œè¯å·²ä¿å­˜åˆ°: </span><span class="token interpolation"><span class="token punctuation">{</span>filename<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> filename
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ä¿å­˜å¤±è´¥: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    lyrics <span class="token operator">=</span> get_all_lyrics_from_ui<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> lyrics<span class="token punctuation">:</span>
        save_lyrics_to_file<span class="token punctuation">(</span>lyrics<span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨å¿«æ·é”®æ‰“å¼€æ­Œè¯çª—å£å¹¶è·å–</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># get_lyrics_with_hotkey.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> pyautogui
<span class="token keyword">import</span> time

<span class="token keyword">def</span> <span class="token function">open_lyrics_window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ä½¿ç”¨å¿«æ·é”®æ‰“å¼€æ­Œè¯çª—å£"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å°è¯•ä½¿ç”¨å¿«æ·é”®æ‰“å¼€æ­Œè¯çª—å£..."</span><span class="token punctuation">)</span>
    
    <span class="token comment"># æŸ¥æ‰¾QQéŸ³ä¹çª—å£</span>
    window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"QQéŸ³ä¹æœªè¿è¡Œ"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    
    <span class="token comment"># æ¿€æ´»çª—å£</span>
    window<span class="token punctuation">.</span>SetActive<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    
    <span class="token comment"># å°è¯•å¸¸ç”¨å¿«æ·é”®</span>
    <span class="token comment"># Ctrl+L æˆ– F7 æ˜¯QQéŸ³ä¹çš„å¸¸ç”¨æ­Œè¯å¿«æ·é”®</span>
    shortcuts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'ctrl+l'</span><span class="token punctuation">,</span> <span class="token string">'f7'</span><span class="token punctuation">,</span> <span class="token string">'ctrl+alt+l'</span><span class="token punctuation">]</span>
    
    <span class="token keyword">for</span> shortcut <span class="token keyword">in</span> shortcuts<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"å°è¯•å¿«æ·é”®: </span><span class="token interpolation"><span class="token punctuation">{</span>shortcut<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        keys <span class="token operator">=</span> shortcut<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">)</span>
        pyautogui<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token operator">*</span>keys<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ£€æŸ¥æ˜¯å¦æœ‰æ–°çš„æ­Œè¯çª—å£å‡ºç°</span>
        <span class="token keyword">for</span> w <span class="token keyword">in</span> auto<span class="token punctuation">.</span>GetRootControl<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> w<span class="token punctuation">.</span>Name <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token string">"æ­Œè¯"</span> <span class="token keyword">in</span> w<span class="token punctuation">.</span>Name <span class="token keyword">or</span> <span class="token string">"Lyric"</span> <span class="token keyword">in</span> w<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°æ­Œè¯çª—å£: </span><span class="token interpolation"><span class="token punctuation">{</span>w<span class="token punctuation">.</span>Name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> w
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªæ‰¾åˆ°æ­Œè¯çª—å£"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">extract_lyrics_from_window</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ä»æ­Œè¯çª—å£ä¸­æå–æ­Œè¯"""</span>
    lyrics <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># æ–¹æ³•1ï¼šæŸ¥æ‰¾æ–‡æœ¬æ§ä»¶</span>
    <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token keyword">in</span> <span class="token punctuation">[</span>auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>TextControl<span class="token punctuation">,</span> 
                                   auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>EditControl<span class="token punctuation">,</span>
                                   auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>DocumentControl<span class="token punctuation">]</span><span class="token punctuation">:</span>
            text <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
            <span class="token keyword">if</span> <span class="token keyword">not</span> text <span class="token keyword">and</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>EditControl<span class="token punctuation">:</span>
                text <span class="token operator">=</span> control<span class="token punctuation">.</span>GetValuePattern<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value
            
            <span class="token keyword">if</span> text <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                lines <span class="token operator">=</span> text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        lyrics<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># æ–¹æ³•2ï¼šå¦‚æœæ˜¯åˆ—è¡¨å½¢å¼</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> lyrics<span class="token punctuation">:</span>
        <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>ListControl<span class="token punctuation">:</span>
                items <span class="token operator">=</span> control<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> item<span class="token punctuation">.</span>Name<span class="token punctuation">:</span>
                        lyrics<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>lyrics<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"QQéŸ³ä¹æ­Œè¯è·å–å·¥å…·"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
    
    <span class="token comment"># å…ˆå°è¯•æ‰“å¼€æ­Œè¯çª—å£</span>
    lyrics_window <span class="token operator">=</span> open_lyrics_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> lyrics_window<span class="token punctuation">:</span>
        <span class="token comment"># ä»æ­Œè¯çª—å£æå–</span>
        lyrics <span class="token operator">=</span> extract_lyrics_from_window<span class="token punctuation">(</span>lyrics_window<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># å›é€€åˆ°ç›´æ¥æœç´¢</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å°è¯•ä»ä¸»çª—å£æœç´¢æ­Œè¯..."</span><span class="token punctuation">)</span>
        lyrics <span class="token operator">=</span> get_all_lyrics_from_ui<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> lyrics<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nè·å–åˆ° </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>lyrics<span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> è¡Œæ­Œè¯:"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>lyrics<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># é¢„è§ˆå‰1000å­—ç¬¦</span>
        
        <span class="token comment"># ä¿å­˜</span>
        save_option <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\næ˜¯å¦ä¿å­˜æ­Œè¯æ–‡ä»¶ï¼Ÿ(y/n): "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> save_option <span class="token operator">==</span> <span class="token string">'y'</span><span class="token punctuation">:</span>
            filename <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ–‡ä»¶åï¼ˆç•™ç©ºä½¿ç”¨æ­Œæ›²åï¼‰: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> filename<span class="token punctuation">:</span>
                filename <span class="token operator">=</span> <span class="token boolean">None</span>
            save_lyrics_to_file<span class="token punctuation">(</span>lyrics<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªèƒ½è·å–åˆ°æ­Œè¯"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>æ–¹æ¡ˆä¸‰ï¼šä»ç½‘ç»œAPIè·å–æ­Œè¯ï¼ˆæ›´å¯é ï¼‰</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># get_lyrics_from_api.py</span>
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> json
<span class="token keyword">import</span> re
<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> quote

<span class="token keyword">def</span> <span class="token function">search_qq_music_song</span><span class="token punctuation">(</span>song_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""æœç´¢QQéŸ³ä¹æ­Œæ›²"""</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># ç®€å•æœç´¢APIï¼ˆéå®˜æ–¹ï¼‰</span>
        url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://c.y.qq.com/soso/fcgi-bin/client_search_cp?w=</span><span class="token interpolation"><span class="token punctuation">{</span>quote<span class="token punctuation">(</span>song_name<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&amp;format=json"</span></span>
        
        headers <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'</span><span class="token punctuation">,</span>
            <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://y.qq.com/'</span>
        <span class="token punctuation">}</span>
        
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
            <span class="token comment"># å¤„ç†JSONPæ ¼å¼</span>
            content <span class="token operator">=</span> response<span class="token punctuation">.</span>text
            <span class="token keyword">if</span> content<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'callback('</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                content <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># ç§»é™¤ callback(...) åŒ…è£…</span>
            
            data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> <span class="token string">'data'</span> <span class="token keyword">in</span> data <span class="token keyword">and</span> <span class="token string">'song'</span> <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token string">'list'</span> <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'song'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                songs <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'song'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'list'</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span> songs<span class="token punctuation">:</span>
                    <span class="token keyword">return</span> songs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># è¿”å›ç¬¬ä¸€é¦–åŒ¹é…çš„æ­Œæ›²</span>
                    
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æœç´¢å¤±è´¥: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">get_lyrics_by_songmid</span><span class="token punctuation">(</span>songmid<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""é€šè¿‡songmidè·å–æ­Œè¯"""</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric_new.fcg?format=json&amp;nobase64=1&amp;songmid=</span><span class="token interpolation"><span class="token punctuation">{</span>songmid<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        
        headers <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'</span><span class="token punctuation">,</span>
            <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://y.qq.com/'</span><span class="token punctuation">,</span>
            <span class="token string">'Origin'</span><span class="token punctuation">:</span> <span class="token string">'https://y.qq.com'</span>
        <span class="token punctuation">}</span>
        
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
            content <span class="token operator">=</span> response<span class="token punctuation">.</span>text
            <span class="token comment"># å¤„ç†JSONPæ ¼å¼</span>
            <span class="token keyword">if</span> content<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'MusicJsonCallback('</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                content <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            
            data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> <span class="token string">'lyric'</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                lyrics <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'lyric'</span><span class="token punctuation">]</span>
                <span class="token comment"># è§£ç Unicodeè½¬ä¹‰åºåˆ—</span>
                lyrics <span class="token operator">=</span> lyrics<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'unicode_escape'</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> lyrics
                
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"è·å–æ­Œè¯å¤±è´¥: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">get_current_song_from_window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""ä»çª—å£æ ‡é¢˜è·å–å½“å‰æ’­æ”¾æ­Œæ›²"""</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            title <span class="token operator">=</span> window<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment"># å¸¸è§æ ¼å¼: "æ­Œæ›²å - æ­Œæ‰‹"</span>
            <span class="token keyword">if</span> <span class="token string">' - '</span> <span class="token keyword">in</span> title<span class="token punctuation">:</span>
                song_name <span class="token operator">=</span> title<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' - '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> song_name
            <span class="token keyword">return</span> title
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
    <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"QQéŸ³ä¹æ­Œè¯è·å–å·¥å…·ï¼ˆç½‘ç»œAPIç‰ˆï¼‰"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
    
    <span class="token comment"># è·å–å½“å‰æ’­æ”¾çš„æ­Œæ›²</span>
    song_name <span class="token operator">=</span> get_current_song_from_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token keyword">not</span> song_name<span class="token punctuation">:</span>
        song_name <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ­Œæ›²å: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> <span class="token keyword">not</span> song_name<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"éœ€è¦æ­Œæ›²åæ‰èƒ½æœç´¢"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æœç´¢æ­Œæ›²: </span><span class="token interpolation"><span class="token punctuation">{</span>song_name<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token comment"># æœç´¢æ­Œæ›²</span>
    song_info <span class="token operator">=</span> search_qq_music_song<span class="token punctuation">(</span>song_name<span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> song_info<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"æ‰¾åˆ°æ­Œæ›²: </span><span class="token interpolation"><span class="token punctuation">{</span>song_info<span class="token punctuation">[</span><span class="token string">'songname'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span>song_info<span class="token punctuation">[</span><span class="token string">'singer'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># è·å–æ­Œè¯</span>
        lyrics <span class="token operator">=</span> get_lyrics_by_songmid<span class="token punctuation">(</span>song_info<span class="token punctuation">[</span><span class="token string">'songmid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> lyrics<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nè·å–åˆ°æ­Œè¯ï¼ˆ</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>lyrics<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> å­—ç¬¦ï¼‰:"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>lyrics<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># é¢„è§ˆå‰1000å­—ç¬¦</span>
            
            <span class="token comment"># ä¿å­˜</span>
            filename <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>song_info<span class="token punctuation">[</span><span class="token string">'songname'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span>song_info<span class="token punctuation">[</span><span class="token string">'singer'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">.lrc"</span></span>
            filename <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'[&lt;&gt;:"/\\|?*]'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
            
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>lyrics<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\næ­Œè¯å·²ä¿å­˜åˆ°: </span><span class="token interpolation"><span class="token punctuation">{</span>filename<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ä¿å­˜å¤±è´¥: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªèƒ½è·å–åˆ°æ­Œè¯"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªæ‰¾åˆ°è¯¥æ­Œæ›²"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>æ–¹æ¡ˆå››ï¼šç»“åˆå¤šç§æ–¹æ³•çš„ç»¼åˆå·¥å…·</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">python</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre><span class="token comment"># qq_music_lyrics_tool.py</span>
<span class="token keyword">import</span> uiautomation <span class="token keyword">as</span> auto
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> json
<span class="token keyword">import</span> re
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> quote

<span class="token keyword">class</span> <span class="token class-name">QQMusicLyricsTool</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>lyrics <span class="token operator">=</span> <span class="token string">""</span>
        
    <span class="token keyword">def</span> <span class="token function">get_current_song_info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""è·å–å½“å‰æ’­æ”¾æ­Œæ›²ä¿¡æ¯"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                title <span class="token operator">=</span> window<span class="token punctuation">.</span>Name<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                
                <span class="token comment"># è§£ææ­Œæ›²åå’Œæ­Œæ‰‹</span>
                <span class="token keyword">if</span> <span class="token string">' - '</span> <span class="token keyword">in</span> title<span class="token punctuation">:</span>
                    parts <span class="token operator">=</span> title<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' - '</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>parts<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">:</span>
                        song_name <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        artist <span class="token operator">=</span> parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'title'</span><span class="token punctuation">:</span> song_name<span class="token punctuation">,</span> <span class="token string">'artist'</span><span class="token punctuation">:</span> artist<span class="token punctuation">,</span> <span class="token string">'full_title'</span><span class="token punctuation">:</span> title<span class="token punctuation">}</span>
                
                <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">'full_title'</span><span class="token punctuation">:</span> title<span class="token punctuation">}</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span>
    
    <span class="token keyword">def</span> <span class="token function">try_ui_extraction</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""å°è¯•ä»UIæå–æ­Œè¯"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å°è¯•ä»UIç•Œé¢æå–æ­Œè¯..."</span><span class="token punctuation">)</span>
        
        window <span class="token operator">=</span> auto<span class="token punctuation">.</span>WindowControl<span class="token punctuation">(</span>ClassName<span class="token operator">=</span><span class="token string">'TXGuiFoundation'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> window<span class="token punctuation">.</span>Exists<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">""</span>
        
        <span class="token comment"># å°è¯•ä¸åŒçš„æ§ä»¶ç±»å‹</span>
        lyrics_parts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        
        <span class="token comment"># æŸ¥æ‰¾æ‰€æœ‰åŒ…å«æ–‡æœ¬çš„æ§ä»¶</span>
        <span class="token keyword">for</span> control <span class="token keyword">in</span> window<span class="token punctuation">.</span>GetChildren<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                text <span class="token operator">=</span> <span class="token string">""</span>
                
                <span class="token keyword">if</span> control<span class="token punctuation">.</span>Name<span class="token punctuation">:</span>
                    text <span class="token operator">=</span> control<span class="token punctuation">.</span>Name
                <span class="token keyword">elif</span> control<span class="token punctuation">.</span>ControlType <span class="token operator">==</span> auto<span class="token punctuation">.</span>ControlType<span class="token punctuation">.</span>EditControl<span class="token punctuation">:</span>
                    text <span class="token operator">=</span> control<span class="token punctuation">.</span>GetValuePattern<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value
                
                <span class="token keyword">if</span> text <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">:</span>  <span class="token comment"># è‡³å°‘10ä¸ªå­—ç¬¦æ‰å¯èƒ½æ˜¯æ­Œè¯</span>
                    <span class="token comment"># ç®€å•çš„æ­Œè¯ç‰¹å¾æ£€æµ‹</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'['</span> <span class="token keyword">in</span> text <span class="token keyword">and</span> <span class="token string">']'</span> <span class="token keyword">in</span> text<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'\n'</span> <span class="token keyword">in</span> text<span class="token punctuation">:</span>
                        lyrics_parts<span class="token punctuation">.</span>append<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
        
        <span class="token keyword">if</span> lyrics_parts<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>lyrics_parts<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">""</span>
    
    <span class="token keyword">def</span> <span class="token function">search_and_download_lyrics</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> song_name<span class="token punctuation">,</span> artist<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""æœç´¢å¹¶ä¸‹è½½æ­Œè¯"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ä»ç½‘ç»œæœç´¢æ­Œè¯: </span><span class="token interpolation"><span class="token punctuation">{</span>song_name<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>artist <span class="token keyword">if</span> artist <span class="token keyword">else</span> <span class="token string">''</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># å°è¯•å¤šä¸ªAPIæº</span>
        
        <span class="token comment"># æº1: QQéŸ³ä¹API</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            search_url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://c.y.qq.com/soso/fcgi-bin/client_search_cp?w=</span><span class="token interpolation"><span class="token punctuation">{</span>quote<span class="token punctuation">(</span>song_name<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&amp;format=json"</span></span>
            headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0'</span><span class="token punctuation">}</span>
            
            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>search_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                content <span class="token operator">=</span> response<span class="token punctuation">.</span>text
                <span class="token keyword">if</span> content<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'callback('</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    content <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                
                data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
                
                <span class="token keyword">if</span> <span class="token string">'data'</span> <span class="token keyword">in</span> data <span class="token keyword">and</span> <span class="token string">'song'</span> <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    songs <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'song'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    
                    <span class="token keyword">for</span> song <span class="token keyword">in</span> songs<span class="token punctuation">:</span>
                        <span class="token comment"># å°è¯•åŒ¹é…æ­Œæ‰‹</span>
                        <span class="token keyword">if</span> artist <span class="token keyword">and</span> <span class="token string">'singer'</span> <span class="token keyword">in</span> song <span class="token keyword">and</span> song<span class="token punctuation">[</span><span class="token string">'singer'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                            song_artist <span class="token operator">=</span> song<span class="token punctuation">[</span><span class="token string">'singer'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
                            <span class="token keyword">if</span> artist<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> song_artist<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">or</span> song_artist<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> artist<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                                <span class="token keyword">return</span> self<span class="token punctuation">.</span>get_lyrics_by_songmid<span class="token punctuation">(</span>song<span class="token punctuation">[</span><span class="token string">'songmid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        
        <span class="token comment"># æº2: å¤‡ç”¨API</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># ä½¿ç”¨ç¬¬ä¸‰æ–¹æ­Œè¯API</span>
            api_url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://api.lyrics.ovh/v1/</span><span class="token interpolation"><span class="token punctuation">{</span>quote<span class="token punctuation">(</span>artist <span class="token keyword">or</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>quote<span class="token punctuation">(</span>song_name<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>api_url<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                data <span class="token operator">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token string">'lyrics'</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                    <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token string">'lyrics'</span><span class="token punctuation">]</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        
        <span class="token keyword">return</span> <span class="token string">""</span>
    
    <span class="token keyword">def</span> <span class="token function">get_lyrics_by_songmid</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> songmid<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""é€šè¿‡songmidè·å–æ­Œè¯"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"https://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric_new.fcg?format=json&amp;nobase64=1&amp;songmid=</span><span class="token interpolation"><span class="token punctuation">{</span>songmid<span class="token punctuation">}</span></span><span class="token string">"</span></span>
            headers <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0'</span><span class="token punctuation">,</span>
                <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://y.qq.com/'</span>
            <span class="token punctuation">}</span>
            
            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
            
            <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                content <span class="token operator">=</span> response<span class="token punctuation">.</span>text
                <span class="token keyword">if</span> content<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'MusicJsonCallback('</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    content <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                
                data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
                
                <span class="token keyword">if</span> <span class="token string">'lyric'</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                    lyrics <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'lyric'</span><span class="token punctuation">]</span>
                    lyrics <span class="token operator">=</span> lyrics<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'unicode_escape'</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> lyrics
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        
        <span class="token keyword">return</span> <span class="token string">""</span>
    
    <span class="token keyword">def</span> <span class="token function">get_lyrics</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""ä¸»æ–¹æ³•ï¼šè·å–æ­Œè¯"""</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"QQéŸ³ä¹æ­Œè¯è·å–å·¥å…·"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
        
        <span class="token comment"># è·å–å½“å‰æ­Œæ›²ä¿¡æ¯</span>
        song_info <span class="token operator">=</span> self<span class="token punctuation">.</span>get_current_song_info<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> song_info<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªæ£€æµ‹åˆ°QQéŸ³ä¹æ’­æ”¾"</span><span class="token punctuation">)</span>
            song_name <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ­Œæ›²å: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            artist <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ­Œæ‰‹ï¼ˆå¯é€‰ï¼‰: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token boolean">None</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"å½“å‰æ’­æ”¾: </span><span class="token interpolation"><span class="token punctuation">{</span>song_info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'full_title'</span><span class="token punctuation">,</span> <span class="token string">'æœªçŸ¥'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            song_name <span class="token operator">=</span> song_info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">,</span> song_info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'full_title'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            artist <span class="token operator">=</span> song_info<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'artist'</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> song_name<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"éœ€è¦æ­Œæ›²å"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        
        <span class="token comment"># æ–¹æ³•1ï¼šå°è¯•ä»UIè·å–</span>
        self<span class="token punctuation">.</span>lyrics <span class="token operator">=</span> self<span class="token punctuation">.</span>try_ui_extraction<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># æ–¹æ³•2ï¼šå¦‚æœUIè·å–å¤±è´¥ï¼Œå°è¯•ç½‘ç»œAPI</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>lyrics <span class="token keyword">or</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lyrics<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">50</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"UIè·å–å¤±è´¥æˆ–æ­Œè¯ä¸å®Œæ•´ï¼Œå°è¯•ç½‘ç»œæœç´¢..."</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>lyrics <span class="token operator">=</span> self<span class="token punctuation">.</span>search_and_download_lyrics<span class="token punctuation">(</span>song_name<span class="token punctuation">,</span> artist<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>lyrics<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>save_lyrics<span class="token punctuation">(</span>song_name<span class="token punctuation">,</span> artist<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æœªèƒ½è·å–åˆ°æ­Œè¯"</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">save_lyrics</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> song_name<span class="token punctuation">,</span> artist<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""ä¿å­˜æ­Œè¯åˆ°æ–‡ä»¶"""</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>lyrics<span class="token punctuation">:</span>
            <span class="token keyword">return</span>
        
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nè·å–åˆ° </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lyrics<span class="token punctuation">.</span>splitlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> è¡Œæ­Œè¯:"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lyrics<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">500</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">"..."</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lyrics<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">500</span> <span class="token keyword">else</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># ç”Ÿæˆæ–‡ä»¶å</span>
        <span class="token keyword">if</span> artist<span class="token punctuation">:</span>
            filename <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>song_name<span class="token punctuation">}</span></span><span class="token string"> - </span><span class="token interpolation"><span class="token punctuation">{</span>artist<span class="token punctuation">}</span></span><span class="token string">.lrc"</span></span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            filename <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>song_name<span class="token punctuation">}</span></span><span class="token string">.lrc"</span></span>
        
        <span class="token comment"># æ¸…ç†éæ³•å­—ç¬¦</span>
        filename <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'[&lt;&gt;:"/\\|?*]'</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span>
        
        <span class="token comment"># ä¿å­˜</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>self<span class="token punctuation">.</span>lyrics<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nâœ… æ­Œè¯å·²ä¿å­˜åˆ°: </span><span class="token interpolation"><span class="token punctuation">{</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"ä¿å­˜å¤±è´¥: </span><span class="token interpolation"><span class="token punctuation">{</span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tool <span class="token operator">=</span> QQMusicLyricsTool<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tool<span class="token punctuation">.</span>get_lyrics<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>å®‰è£…ä¾èµ–ï¼š</span></h2><div class="md-code-block md-code-block-light"><div class="md-code-block-banner-wrap"><div class="md-code-block-banner md-code-block-banner-lite"><div class="_121d384"><div class="d2a24f03"><span class="d813de27">bash</span></div><div class="d2a24f03 _246a029"><div class="efa13877"></div></div></div></div></div><pre>pip <span class="token function">install</span> requests pyautogui</pre><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _33882ae"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none" class="_9bc997d _28d7e84"><path d="M-5.24537e-07 0C-2.34843e-07 6.62742 5.37258 12 12 12L0 12L-5.24537e-07 0Z" fill="currentColor"></path></svg></div><h2><span>ä½¿ç”¨å»ºè®®ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>é¦–é€‰æ–¹æ¡ˆå››</span></strong><span>ï¼šç»¼åˆå·¥å…·æœ€å¯é ï¼Œä¼šå°è¯•å¤šç§æ–¹æ³•</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>ç½‘ç»œAPIæ–¹æ³•æœ€å¯é </span></strong><span>ï¼šæ–¹æ¡ˆä¸‰å’Œæ–¹æ¡ˆå››çš„ç½‘ç»œAPIæ–¹æ³•é€šå¸¸èƒ½è·å–åˆ°å®Œæ•´çš„LRCæ ¼å¼æ­Œè¯</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>UIæ–¹æ³•æœ‰é™</span></strong><span>ï¼šä»ç•Œé¢è·å–é€šå¸¸åªèƒ½è·å–å½“å‰æ˜¾ç¤ºçš„æ­Œè¯ï¼Œä¸æ˜¯å®Œæ•´æ­Œè¯</span></p></li></ol><h2><span>å¦‚æœæ‰€æœ‰æ–¹æ³•éƒ½å¤±è´¥ï¼š</span></h2><ol start="1"><li><p class="ds-markdown-paragraph"><strong><span>æ£€æŸ¥ç½‘ç»œè¿æ¥</span></strong><span>ï¼šç½‘ç»œAPIéœ€è¦äº’è”ç½‘è¿æ¥</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>æ‰‹åŠ¨æœç´¢</span></strong><span>ï¼šåœ¨æµè§ˆå™¨ä¸­è®¿é—® </span><a href="https://y.qq.com/" target="_blank" rel="noreferrer"><span>https://y.qq.com/</span></a><span> æœç´¢æ­Œæ›²è·å–æ­Œè¯</span></p></li><li><p class="ds-markdown-paragraph"><strong><span>ä½¿ç”¨ä¸“ä¸šå·¥å…·</span></strong><span>ï¼šå¦‚ LyricEaseã€æ­Œè¯é€‚é…ç­‰ä¸“ä¸šæ­Œè¯ä¸‹è½½å·¥å…·</span></p></li></ol><p class="ds-markdown-paragraph"><span>è¿è¡Œæ–¹æ¡ˆå››çš„å·¥å…·ï¼Œå®ƒä¼šè‡ªåŠ¨å°è¯•å¤šç§æ–¹æ³•è·å–æ­Œè¯ã€‚</span></p></div>
        </div>
</body>
</html>